

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Canonical Extension Types &#8212; Apache Arrow v21.0.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'format/CanonicalExtensions';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/docs/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="canonical" href="https://arrow.apache.org/docs/format/CanonicalExtensions.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Other Data Structures" href="Other.html" />
    <link rel="prev" title="Changing the Apache Arrow Format Specification" href="Changing.html" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="21.0.0" />

  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    /* We explicitly disable cookie tracking to avoid privacy issues */
    _paq.push(['disableCookies']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="https://analytics.apache.org/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '20']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/arrow.png" class="logo__image only-light" alt="Apache Arrow v21.0.0 - Home"/>
    <img src="../_static/arrow-dark.png" class="logo__image only-dark pst-js-only" alt="Apache Arrow v21.0.0 - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-user-analytics-cookie-enabled="false"
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-user-analytics-cookie-enabled="false"
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Columnar.html">Arrow Columnar Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="Versioning.html">Format Versioning and Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changing.html">Changing the Apache Arrow Format Specification</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Canonical Extension Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="Other.html">Other Data Structures</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="CDataInterface.html">The Arrow C data interface</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="CDataInterface/PyCapsuleInterface.html">The Arrow PyCapsule Interface</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="CStreamInterface.html">The Arrow C stream interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CDeviceDataInterface.html">The Arrow C Device data interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatisticsSchema.html">Statistics schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="DissociatedIPC.html">Dissociated IPC Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="Flight.html">Arrow Flight RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="FlightSql.html">Arrow Flight SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADBC.html">ADBC: Arrow Database Connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Integration.html">Integration Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Specifications</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Canonical Extension Types</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="canonical-extension-types">
<span id="format-canonical-extensions"></span><h1>Canonical Extension Types<a class="headerlink" href="#canonical-extension-types" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The Arrow columnar format allows defining
<a class="reference internal" href="Columnar.html#format-metadata-extension-types"><span class="std std-ref">extension types</span></a> so as to extend
standard Arrow data types with custom semantics.  Often these semantics
will be specific to a system or application.  However, it is beneficial
to share the definitions of well-known extension types so as to improve
interoperability between different systems integrating Arrow columnar data.</p>
<section id="standardization">
<h3>Standardization<a class="headerlink" href="#standardization" title="Permalink to this heading">#</a></h3>
<p>These rules must be followed for the standardization of canonical extension
types:</p>
<ul class="simple">
<li><p>Canonical extension types are described and maintained below in this document.</p></li>
<li><p>Each canonical extension type requires a distinct discussion and vote
on the <a class="reference external" href="https://arrow.apache.org/community/">Arrow development mailing-list</a>.</p></li>
<li><p>The specification text to be added <em>must</em> follow these requirements:</p>
<ol class="arabic simple">
<li><p>It <em>must</em> define a well-defined extension name starting with “<code class="docutils literal notranslate"><span class="pre">arrow.</span></code>”.</p></li>
<li><p>Its parameters, if any, <em>must</em> be described in the proposal.</p></li>
<li><p>Its serialization <em>must</em> be described in the proposal and should
not require unduly implementation work or unusual software dependencies
(for example, a trivial custom text format or a JSON-based format would be acceptable).</p></li>
<li><p>Its expected semantics <em>should</em> be described as well and any
potential ambiguities or pain points addressed or at least mentioned.</p></li>
</ol>
</li>
<li><p>The extension type <em>should</em> have one implementation submitted;
preferably two if non-trivial (for example if parameterized).</p></li>
</ul>
</section>
<section id="making-modifications">
<h3>Making Modifications<a class="headerlink" href="#making-modifications" title="Permalink to this heading">#</a></h3>
<p>Like standard Arrow data types, canonical extension types should be considered
stable once standardized.  Modifying a canonical extension type (for example
to expand the set of parameters) should be an exceptional event, follow the
same rules as laid out above, and provide backwards compatibility guarantees.</p>
</section>
</section>
<section id="official-list">
<h2>Official List<a class="headerlink" href="#official-list" title="Permalink to this heading">#</a></h2>
<section id="fixed-shape-tensor">
<span id="fixed-shape-tensor-extension"></span><h3>Fixed shape tensor<a class="headerlink" href="#fixed-shape-tensor" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.fixed_shape_tensor</span></code>.</p></li>
<li><p>The storage type of the extension: <code class="docutils literal notranslate"><span class="pre">FixedSizeList</span></code> where:</p>
<ul class="simple">
<li><p><strong>value_type</strong> is the data type of individual tensor elements.</p></li>
<li><p><strong>list_size</strong> is the product of all the elements in tensor shape.</p></li>
</ul>
</li>
<li><p>Extension type parameters:</p>
<ul class="simple">
<li><p><strong>value_type</strong> = the Arrow data type of individual tensor elements.</p></li>
<li><p><strong>shape</strong> = the physical shape of the contained tensors
as an array.</p></li>
</ul>
<p>Optional parameters describing the logical layout:</p>
<ul>
<li><p><strong>dim_names</strong> = explicit names to tensor dimensions
as an array. The length of it should be equal to the shape
length and equal to the number of dimensions.</p>
<p><code class="docutils literal notranslate"><span class="pre">dim_names</span></code> can be used if the dimensions have well-known
names and they map to the physical layout (row-major).</p>
</li>
<li><p><strong>permutation</strong>  = indices of the desired ordering of the
original dimensions, defined as an array.</p>
<p>The indices contain a permutation of the values [0, 1, .., N-1] where
N is the number of dimensions. The permutation indicates which
dimension of the logical layout corresponds to which dimension of the
physical tensor (the i-th dimension of the logical view corresponds
to the dimension with number <code class="docutils literal notranslate"><span class="pre">permutations[i]</span></code> of the physical tensor).</p>
<p>Permutation can be useful in case the logical order of
the tensor is a permutation of the physical order (row-major).</p>
<p>When logical and physical layout are equal, the permutation will always
be ([0, 1, .., N-1]) and can therefore be left out.</p>
</li>
</ul>
</li>
<li><p>Description of the serialization:</p>
<p>The metadata must be a valid JSON object including shape of
the contained tensors as an array with key <strong>“shape”</strong> plus optional
dimension names with keys <strong>“dim_names”</strong> and ordering of the
dimensions with key <strong>“permutation”</strong>.</p>
<ul>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;shape&quot;:</span> <span class="pre">[2,</span> <span class="pre">5]}</span></code></p></li>
<li><p>Example with <code class="docutils literal notranslate"><span class="pre">dim_names</span></code> metadata for NCHW ordered data:</p>
<p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;shape&quot;:</span> <span class="pre">[100,</span> <span class="pre">200,</span> <span class="pre">500],</span> <span class="pre">&quot;dim_names&quot;:</span> <span class="pre">[&quot;C&quot;,</span> <span class="pre">&quot;H&quot;,</span> <span class="pre">&quot;W&quot;]}</span></code></p>
</li>
<li><p>Example of permuted 3-dimensional tensor:</p>
<p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;shape&quot;:</span> <span class="pre">[100,</span> <span class="pre">200,</span> <span class="pre">500],</span> <span class="pre">&quot;permutation&quot;:</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]}</span></code></p>
<p>This is the physical layout shape and the shape of the logical
layout would in this case be <code class="docutils literal notranslate"><span class="pre">[500,</span> <span class="pre">100,</span> <span class="pre">200]</span></code>.</p>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Elements in a fixed shape tensor extension array are stored
in row-major/C-contiguous order.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Other Data Structures in Arrow include a
<a class="reference external" href="https://arrow.apache.org/docs/format/Other.html">Tensor (Multi-dimensional Array)</a>
to be used as a message in the interprocess communication machinery (IPC).</p>
<p>This structure has no relationship with the Fixed shape tensor extension type defined
by this specification. Instead, this extension type lets one use fixed shape tensors
as elements in a field of a RecordBatch or a Table.</p>
</div>
</section>
<section id="variable-shape-tensor">
<span id="variable-shape-tensor-extension"></span><h3>Variable shape tensor<a class="headerlink" href="#variable-shape-tensor" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.variable_shape_tensor</span></code>.</p></li>
<li><p>The storage type of the extension is: <code class="docutils literal notranslate"><span class="pre">StructArray</span></code> where struct
is composed of <strong>data</strong> and <strong>shape</strong> fields describing a single
tensor per row:</p>
<ul class="simple">
<li><p><strong>data</strong> is a <code class="docutils literal notranslate"><span class="pre">List</span></code> holding tensor elements (each list element is
a single tensor). The List’s value type is the value type of the tensor,
such as an integer or floating-point type.</p></li>
<li><p><strong>shape</strong> is a <code class="docutils literal notranslate"><span class="pre">FixedSizeList&lt;int32&gt;[ndim]</span></code> of the tensor shape where
the size of the list <code class="docutils literal notranslate"><span class="pre">ndim</span></code> is equal to the number of dimensions of the
tensor.</p></li>
</ul>
</li>
<li><p>Extension type parameters:</p>
<ul class="simple">
<li><p><strong>value_type</strong> = the Arrow data type of individual tensor elements.</p></li>
</ul>
<p>Optional parameters describing the logical layout:</p>
<ul>
<li><p><strong>dim_names</strong> = explicit names to tensor dimensions
as an array. The length of it should be equal to the shape
length and equal to the number of dimensions.</p>
<p><code class="docutils literal notranslate"><span class="pre">dim_names</span></code> can be used if the dimensions have well-known
names and they map to the physical layout (row-major).</p>
</li>
<li><p><strong>permutation</strong>  = indices of the desired ordering of the
original dimensions, defined as an array.</p>
<p>The indices contain a permutation of the values [0, 1, .., N-1] where
N is the number of dimensions. The permutation indicates which
dimension of the logical layout corresponds to which dimension of the
physical tensor (the i-th dimension of the logical view corresponds
to the dimension with number <code class="docutils literal notranslate"><span class="pre">permutations[i]</span></code> of the physical tensor).</p>
<p>Permutation can be useful in case the logical order of
the tensor is a permutation of the physical order (row-major).</p>
<p>When logical and physical layout are equal, the permutation will always
be ([0, 1, .., N-1]) and can therefore be left out.</p>
</li>
<li><p><strong>uniform_shape</strong> = sizes of individual tensor’s dimensions which are
guaranteed to stay constant in uniform dimensions and can vary in
non-uniform dimensions. This holds over all tensors in the array.
Sizes in uniform dimensions are represented with int32 values, while
sizes of the non-uniform dimensions are not known in advance and are
represented with null. If <code class="docutils literal notranslate"><span class="pre">uniform_shape</span></code> is not provided it is assumed
that all dimensions are non-uniform.
An array containing a tensor with shape (2, 3, 4) and whose first and
last dimensions are uniform would have <code class="docutils literal notranslate"><span class="pre">uniform_shape</span></code> (2, null, 4).
This allows for interpreting the tensor correctly without accounting for
uniform dimensions while still permitting optional optimizations that
take advantage of the uniformity.</p></li>
</ul>
</li>
<li><p>Description of the serialization:</p>
<p>The metadata must be a valid JSON object that optionally includes
dimension names with keys <strong>“dim_names”</strong> and  ordering of dimensions
with key <strong>“permutation”</strong>.
Shapes of tensors can be defined in a subset of dimensions by providing
key <strong>“uniform_shape”</strong>.
Minimal metadata is an empty string.</p>
<ul>
<li><p>Example with <code class="docutils literal notranslate"><span class="pre">dim_names</span></code> metadata for NCHW ordered data (note that the first
logical dimension, <code class="docutils literal notranslate"><span class="pre">N</span></code>, is mapped to the <strong>data</strong> List array: each element in the List
is a CHW tensor and the List of tensors implicitly constitutes a single NCHW tensor):</p>
<p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;dim_names&quot;:</span> <span class="pre">[&quot;C&quot;,</span> <span class="pre">&quot;H&quot;,</span> <span class="pre">&quot;W&quot;]</span> <span class="pre">}</span></code></p>
</li>
<li><p>Example with <code class="docutils literal notranslate"><span class="pre">uniform_shape</span></code> metadata for a set of color images
with fixed height, variable width and three color channels:</p>
<p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;dim_names&quot;:</span> <span class="pre">[&quot;H&quot;,</span> <span class="pre">&quot;W&quot;,</span> <span class="pre">&quot;C&quot;],</span> <span class="pre">&quot;uniform_shape&quot;:</span> <span class="pre">[400,</span> <span class="pre">null,</span> <span class="pre">3]</span> <span class="pre">}</span></code></p>
</li>
<li><p>Example of permuted 3-dimensional tensor:</p>
<p><code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;permutation&quot;:</span> <span class="pre">[2,</span> <span class="pre">0,</span> <span class="pre">1]</span> <span class="pre">}</span></code></p>
<p>For example, if the physical <strong>shape</strong> of an individual tensor
is <code class="docutils literal notranslate"><span class="pre">[100,</span> <span class="pre">200,</span> <span class="pre">500]</span></code>, this permutation would denote a logical shape
of <code class="docutils literal notranslate"><span class="pre">[500,</span> <span class="pre">100,</span> <span class="pre">200]</span></code>.</p>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the exception of <code class="docutils literal notranslate"><span class="pre">permutation</span></code>, the parameters and storage
of VariableShapeTensor relate to the <em>physical</em> storage of the tensor.</p>
<dl class="simple">
<dt>For example, consider a tensor with::</dt><dd><p>shape = [10, 20, 30]
dim_names = [x, y, z]
permutations = [2, 0, 1]</p>
</dd>
</dl>
<p>This means the logical tensor has names [z, x, y] and shape [30, 10, 20].</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Values inside each <strong>data</strong> tensor element are stored in row-major/C-contiguous
order according to the corresponding <strong>shape</strong>.</p>
</div>
</section>
<section id="json">
<span id="json-extension"></span><h3>JSON<a class="headerlink" href="#json" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.json</span></code>.</p></li>
<li><p>The storage type of this extension is <code class="docutils literal notranslate"><span class="pre">String</span></code> or
<code class="docutils literal notranslate"><span class="pre">LargeString</span></code> or <code class="docutils literal notranslate"><span class="pre">StringView</span></code>.
Only UTF-8 encoded JSON as specified in <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8259">rfc8259</a> is supported.</p></li>
<li><p>Extension type parameters:</p>
<p>This type does not have any parameters.</p>
</li>
<li><p>Description of the serialization:</p>
<p>Metadata is either an empty string or a JSON string with an empty object.
In the future, additional fields may be added, but they are not required
to interpret the array.</p>
</li>
</ul>
</section>
<section id="uuid">
<span id="uuid-extension"></span><h3>UUID<a class="headerlink" href="#uuid" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.uuid</span></code>.</p></li>
<li><p>The storage type of the extension is <code class="docutils literal notranslate"><span class="pre">FixedSizeBinary</span></code> with a length of 16 bytes.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A specific UUID version is not required or guaranteed. This extension represents
UUIDs as FixedSizeBinary(16) with big-endian notation and does not interpret the bytes in any way.</p>
</div>
</section>
<section id="opaque">
<h3>Opaque<a class="headerlink" href="#opaque" title="Permalink to this heading">#</a></h3>
<p>Opaque represents a type that an Arrow-based system received from an external
(often non-Arrow) system, but that it cannot interpret.  In this case, it can
pass on Opaque to its clients to at least show that a field exists and
preserve metadata about the type from the other system.</p>
<p>Extension parameters:</p>
<ul>
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.opaque</span></code>.</p></li>
<li><p>The storage type of this extension is any type.  If there is no underlying
data, the storage type should be Null.</p></li>
<li><p>Extension type parameters:</p>
<ul class="simple">
<li><p><strong>type_name</strong> = the name of the unknown type in the external system.</p></li>
<li><p><strong>vendor_name</strong> = the name of the external system.</p></li>
</ul>
</li>
<li><p>Description of the serialization:</p>
<p>A valid JSON object containing the parameters as fields.  In the future,
additional fields may be added, but all fields current and future are never
required to interpret the array.</p>
<p>Developers <strong>should not</strong> attempt to enable public semantic interoperability
of Opaque by canonicalizing specific values of these parameters.</p>
</li>
</ul>
<section id="rationale">
<h4>Rationale<a class="headerlink" href="#rationale" title="Permalink to this heading">#</a></h4>
<p>Interfacing with non-Arrow systems requires a way to handle data that doesn’t
have an equivalent Arrow type.  In this case, use the Opaque type, which
explicitly represents an unsupported field.  Other solutions are inadequate:</p>
<ul class="simple">
<li><p>Raising an error means even one unsupported field makes all operations
impossible, even if (for instance) the user is just trying to view a schema.</p></li>
<li><p>Dropping unsupported columns misleads the user as to the actual schema.</p></li>
<li><p>An extension type may not exist for the unsupported type.</p></li>
<li><p>Generating an extension type on the fly would falsely imply support.</p></li>
</ul>
<p>Applications <strong>should not</strong> make conventions around vendor_name and type_name.
These parameters are meant for human end users to understand what type wasn’t
supported.  Applications may try to interpret these fields, but must be
prepared for breakage (e.g., when the type becomes supported with a custom
extension type later on).  Similarly, <strong>Opaque is not a generic container for
file formats</strong>.  Considerations such as MIME types are irrelevant.  In both of
these cases, create a custom extension type instead.</p>
<p>Examples:</p>
<ul>
<li><p>A Flight SQL service that supports connecting external databases may
encounter columns with unsupported types in external tables.  In this case,
it can use the Opaque[Null] type to at least report that a column exists
with a particular name and type name.  This lets clients know that a column
exists, but is not supported.  Null is used as the storage type here because
only schemas are involved.</p>
<p>An example of the extension metadata would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;type_name&quot;</span><span class="p">:</span> <span class="s2">&quot;varray&quot;</span><span class="p">,</span> <span class="s2">&quot;vendor_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Oracle&quot;</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The ADBC PostgreSQL driver gets results as a series of length-prefixed byte
fields.  But the driver will not always know how to parse the bytes, as
there may be extensions (e.g. PostGIS).  It can use Opaque[Binary] to still
return those bytes to the application, which may be able to parse the data
itself.  Opaque differentiates the column from an actual binary column and
makes it clear that the value is directly from PostgreSQL.  (A custom
extension type is preferred, but there will always be extensions that the
driver does not know about.)</p>
<p>An example of the extension metadata would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;type_name&quot;</span><span class="p">:</span> <span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;vendor_name&quot;</span><span class="p">:</span> <span class="s2">&quot;PostGIS&quot;</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The ADBC PostgreSQL driver may also know how to parse the bytes, but not
know the intended semantics.  For example, <a class="reference external" href="https://www.postgresql.org/docs/current/rowtypes.html">composite types</a> can add new
semantics to existing types, somewhat like Arrow extension types.  The
driver would be able to parse the underlying bytes in this case, but would
still use the Opaque type.</p>
<p>Consider the example in the PostgreSQL documentation of a <code class="docutils literal notranslate"><span class="pre">complex</span></code> type.
Mapping the type to a plain Arrow <code class="docutils literal notranslate"><span class="pre">struct</span></code> type would lose meaning, just
like how an Arrow system deciding to treat all extension types by dropping
the extension metadata would be undesirable.  Instead, the driver can use
Opaque[Struct] to pass on the composite type info.  (It would be wrong to
try to map this to an Arrow-defined complex type: it does not know the
proper semantics of a user-defined type, which cannot and should not be
hardcoded into the driver in the first place.)</p>
<p>An example of the extension metadata would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;type_name&quot;</span><span class="p">:</span> <span class="s2">&quot;database_name.schema_name.complex&quot;</span><span class="p">,</span> <span class="s2">&quot;vendor_name&quot;</span><span class="p">:</span> <span class="s2">&quot;PostgreSQL&quot;</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The JDBC adapter in the Arrow Java libraries converts JDBC result sets into
Arrow arrays, and can get Arrow schemas from result sets.  JDBC, however,
allows drivers to return <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/sql/Types.html#OTHER">arbitrary Java objects</a>.</p>
<p>The driver can use Opaque[Null] as a placeholder during schema conversion,
only erroring if the application tries to fetch the actual data.  That way,
clients can at least introspect result schemas to decide whether it can
proceed to fetch the data, or only query certain columns.</p>
<p>An example of the extension metadata would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;type_name&quot;</span><span class="p">:</span> <span class="s2">&quot;OTHER&quot;</span><span class="p">,</span> <span class="s2">&quot;vendor_name&quot;</span><span class="p">:</span> <span class="s2">&quot;JDBC driver name&quot;</span><span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="bit-boolean">
<h3>8-bit Boolean<a class="headerlink" href="#bit-boolean" title="Permalink to this heading">#</a></h3>
<p>Bool8 represents a boolean value using 1 byte (8 bits) to store each value instead of only 1 bit as in
the original Arrow Boolean type. Although less compact than the original representation, Bool8 may have
better zero-copy compatibility with various systems that also store booleans using 1 byte.</p>
<ul>
<li><p>Extension name: <code class="docutils literal notranslate"><span class="pre">arrow.bool8</span></code>.</p></li>
<li><p>The storage type of this extension is <code class="docutils literal notranslate"><span class="pre">Int8</span></code> where:</p>
<ul class="simple">
<li><p><strong>false</strong> is denoted by the value <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>true</strong> can be specified using any non-zero value. Preferably <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
</ul>
</li>
<li><p>Extension type parameters:</p>
<p>This type does not have any parameters.</p>
</li>
<li><p>Description of the serialization:</p>
<p>Metadata is an empty string.</p>
</li>
</ul>
</section>
</section>
<section id="community-extension-types">
<h2>Community Extension Types<a class="headerlink" href="#community-extension-types" title="Permalink to this heading">#</a></h2>
<p>In addition to the canonical extension types listed above, there exist Arrow
extension types that have been established as standards within specific domain
areas. These have not been officially designated as canonical through a
discussion and vote on the Arrow development mailing list but are well known
within subcommunities of Arrow developers.</p>
<section id="geoarrow">
<h3>GeoArrow<a class="headerlink" href="#geoarrow" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/geoarrow/geoarrow">GeoArrow</a> defines a collection of
Arrow extension types for representing vector geometries. It is well known
within the Arrow geospatial subcommunity. The GeoArrow specification is not yet
finalized.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Changing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Changing the Apache Arrow Format Specification</p>
      </div>
    </a>
    <a class="right-next"
       href="Other.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Other Data Structures</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardization">Standardization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#making-modifications">Making Modifications</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#official-list">Official List</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-shape-tensor">Fixed shape tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-shape-tensor">Variable shape tensor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#json">JSON</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uuid">UUID</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#opaque">Opaque</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rationale">Rationale</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-boolean">8-bit Boolean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#community-extension-types">Community Extension Types</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geoarrow">GeoArrow</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/apache/arrow/edit/main/docs/source/format/CanonicalExtensions.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2016-2025 Apache Software Foundation.
Apache Arrow, Arrow, Apache, the Apache feather logo, and the Apache Arrow project logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>