<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Schema class — Schema • Arrow R Package</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Schema class — Schema"><meta property="og:description" content="A Schema is an Arrow object containing Fields, which map names to
Arrow data types. Create a Schema when you
want to convert an R data.frame to Arrow but don't want to rely on the
default mapping of R types to Arrow types, such as when you want to choose a
specific numeric precision, or when creating a Dataset and you want to
ensure a specific schema rather than inferring it from the various files.
Many Arrow objects, including Table and Dataset, have a $schema method
(active binding) that lets you access their schema."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Arrow R Package</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://arrow.apache.org/" class="external-link">❯❯❯</a>
</li>
<li>
  <a href="../articles/arrow.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/install.html">Installing the Arrow Package on Linux</a>
    </li>
    <li>
      <a href="../articles/dataset.html">Working with Arrow Datasets and dplyr</a>
    </li>
    <li>
      <a href="../articles/fs.html">Working with Cloud Storage (S3)</a>
    </li>
    <li>
      <a href="../articles/python.html">Apache Arrow in Python and R with reticulate</a>
    </li>
    <li>
      <a href="../articles/flight.html">Connecting to Flight RPC Servers</a>
    </li>
    <li>
      <a href="../articles/developing.html">Arrow R Developer Guide</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Developers</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/developers/setup.html">Developer Environment Setup</a>
        </li>
        <li>
          <a href="../articles/developers/workflow.html">Common Workflow Tasks</a>
        </li>
        <li>
          <a href="../articles/developers/debugging.html">Debugging</a>
        </li>
        <li>
          <a href="../articles/developers/install_details.html">Package Installation Details</a>
        </li>
        <li>
          <a href="../articles/developers/docker.html">Docker</a>
        </li>
        <li>
          <a href="../articles/developers/bindings.html">Writing Bindings</a>
        </li>
      </ul></li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Project docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://arrow.apache.org/docs/format/Columnar.html" class="external-link">Specification</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/c_glib" class="external-link">C GLib</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/cpp" class="external-link">C++</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/java" class="external-link">Java</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/js" class="external-link">JavaScript</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/python" class="external-link">Python</a>
    </li>
    <li>
      <a href="../index.html">R</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Schema class</h1>
    <small class="dont-index">Source: <a href="https://github.com/apache/arrow/blob/master/r/R/schema.R" class="external-link"><code>R/schema.R</code></a></small>
    <div class="hidden name"><code>Schema.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A <code>Schema</code> is an Arrow object containing <a href="Field.html">Field</a>s, which map names to
Arrow <a href="data-type.html">data types</a>. Create a <code>Schema</code> when you
want to convert an R <code>data.frame</code> to Arrow but don't want to rely on the
default mapping of R types to Arrow types, such as when you want to choose a
specific numeric precision, or when creating a <a href="Dataset.html">Dataset</a> and you want to
ensure a specific schema rather than inferring it from the various files.</p>
<p>Many Arrow objects, including <a href="Table.html">Table</a> and <a href="Dataset.html">Dataset</a>, have a <code>$schema</code> method
(active binding) that lets you access their schema.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">schema</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>...</dt>
<dd><p><a href="Field.html">fields</a> or field name/<a href="data-type.html">data type</a> pairs</p></dd>
</dl></div>
    <div id="methods">
    <h2>Methods</h2>
    

<ul><li><p><code>$ToString()</code>: convert to a string</p></li>
<li><p><code>$field(i)</code>: returns the field at index <code>i</code> (0-based)</p></li>
<li><p><code>$GetFieldByName(x)</code>: returns the field with name <code>x</code></p></li>
<li><p><code>$WithMetadata(metadata)</code>: returns a new <code>Schema</code> with the key-value
<code>metadata</code> set. Note that all list elements in <code>metadata</code> will be coerced
to <code>character</code>.</p></li>
</ul></div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    

<ul><li><p><code>$names</code>: returns the field names (called in <code>names(Schema)</code>)</p></li>
<li><p><code>$num_fields</code>: returns the number of fields (called in <code>length(Schema)</code>)</p></li>
<li><p><code>$fields</code>: returns the list of <code>Field</code>s in the <code>Schema</code>, suitable for
iterating over</p></li>
<li><p><code>$HasMetadata</code>: logical: does this <code>Schema</code> have extra metadata?</p></li>
<li><p><code>$metadata</code>: returns the key-value metadata as a named list.
Modify or replace by assigning in (<code>sch$metadata &lt;- new_metadata</code>).
All list elements are coerced to string.</p></li>
</ul></div>
    <div id="r-metadata">
    <h2>R Metadata</h2>
    


<p>When converting a data.frame to an Arrow Table or RecordBatch, attributes
from the <code>data.frame</code> are saved alongside tables so that the object can be
reconstructed faithfully in R (e.g. with <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>). This metadata
can be both at the top-level of the <code>data.frame</code> (e.g. <code>attributes(df)</code>) or
at the column (e.g. <code>attributes(df$col_a)</code>) or for list columns only:
element level (e.g. <code>attributes(df[1, "col_a"])</code>). For example, this allows
for storing <code>haven</code> columns in a table and being able to faithfully
re-create them when pulled back into R. This metadata is separate from the
schema (column names and types) which is compatible with other Arrow
clients. The R metadata is only read by R and is ignored by other clients
(e.g. Pandas has its own custom metadata). This metadata is stored in
<code>$metadata$r</code>.</p>
<p>Since Schema metadata keys and values must be strings, this metadata is
saved by serializing R's attribute list structure to a string. If the
serialized metadata exceeds 100Kb in size, by default it is compressed
starting in version 3.0.0. To disable this compression (e.g. for tables
that are compatible with Arrow versions before 3.0.0 and include large
amounts of metadata), set the option <code>arrow.compress_metadata</code> to <code>FALSE</code>.
Files with compressed metadata are readable by older versions of arrow, but
the metadata is dropped.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">schema</span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="data-type.html">int32</a></span><span class="op">(</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="data-type.html">float64</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Schema</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a: int32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b: double</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">schema</span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="Field.html">field</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="fu"><a href="Field.html">field</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="fu"><a href="data-type.html">bool</a></span><span class="op">(</span><span class="op">)</span>, nullable <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="fu"><a href="Field.html">field</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="fu"><a href="data-type.html">string</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Schema</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b: double</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c: bool not null</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d: string</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, col2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="Table.html">arrow_table</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tab1</span><span class="op">$</span><span class="va">schema</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Schema</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col1: int32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col2: double</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> See $metadata for additional Schema metadata</span>
<span class="r-in"><span class="va">tab2</span> <span class="op">&lt;-</span> <span class="fu"><a href="Table.html">arrow_table</a></span><span class="op">(</span><span class="va">df</span>, schema <span class="op">=</span> <span class="fu">schema</span><span class="op">(</span>col1 <span class="op">=</span> <span class="fu"><a href="data-type.html">int8</a></span><span class="op">(</span><span class="op">)</span>, col2 <span class="op">=</span> <span class="fu"><a href="data-type.html">float32</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tab2</span><span class="op">$</span><span class="va">schema</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Schema</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col1: int8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col2: float</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> See $metadata for additional Schema metadata</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Neal Richardson, Ian Cook, Nic Crane, Jonathan Keane, Romain François, Jeroen Ooms, Apache Arrow.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

