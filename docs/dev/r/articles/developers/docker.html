<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • Arrow R Package</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><script src="../../extra.js"></script><meta property="og:title" content="">
<meta property="og:description" content="arrow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">Arrow R Package</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://arrow.apache.org/" class="external-link">❯❯❯</a>
</li>
<li>
  <a href="../../articles/arrow.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/install.html">Installing the Arrow Package on Linux</a>
    </li>
    <li>
      <a href="../../articles/dataset.html">Working with Arrow Datasets and dplyr</a>
    </li>
    <li>
      <a href="../../articles/fs.html">Working with Cloud Storage (S3)</a>
    </li>
    <li>
      <a href="../../articles/python.html">Apache Arrow in Python and R with reticulate</a>
    </li>
    <li>
      <a href="../../articles/flight.html">Connecting to Flight RPC Servers</a>
    </li>
    <li>
      <a href="../../articles/developing.html">Arrow R Developer Guide</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Developers</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/developers/setup.html">Developer Environment Setup</a>
        </li>
        <li>
          <a href="../../articles/developers/workflow.html">Common Workflow Tasks</a>
        </li>
        <li>
          <a href="../../articles/developers/debugging.html">Debugging</a>
        </li>
        <li>
          <a href="../../articles/developers/install_details.html">Package Installation Details</a>
        </li>
        <li>
          <a href="../../articles/developers/docker.html">Docker</a>
        </li>
        <li>
          <a href="../../articles/developers/bindings.html">Writing Bindings</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Project docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://arrow.apache.org/docs/format/Columnar.html" class="external-link">Specification</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/c_glib" class="external-link">C GLib</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/cpp" class="external-link">C++</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/java" class="external-link">Java</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/js" class="external-link">JavaScript</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/python" class="external-link">Python</a>
    </li>
    <li>
      <a href="../../index.html">R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/apache/arrow/blob/master/r/vignettes/developers/docker.Rmd" class="external-link"><code>vignettes/developers/docker.Rmd</code></a></small>
      <div class="hidden name"><code>docker.Rmd</code></div>

    </div>

    
    
<div class="section level1">
<h1 id="using-docker-with-arrow">Using docker with Arrow<a class="anchor" aria-label="anchor" href="#using-docker-with-arrow"></a>
</h1>
<p>Arrow is compatible with a huge number of combinations of OSs, OS versions, compilers, R versions, and other variables. Sometimes these combinations of variables means that behaviours are found in some environments which cannot be replicated in others. In addition, there are different ways of building Arrow, for example, using environment variables to specify the building of optional components.</p>
<p>What all this means is that you may need to use a different setup to the one in which you are working, when diagnosing a bug or testing out a new feature which you have reason to believe may be affected by these variables. One way to do this is so spin up a Docker image containing the desired setup.</p>
<p>This article provides a basic guide to using Docker in your R development.</p>
<div class="section level2">
<h2 id="how-do-i-run-a-docker-container">How do I run a Docker container?<a class="anchor" aria-label="anchor" href="#how-do-i-run-a-docker-container"></a>
</h2>
<p>There are a number of images which have been created for the convenience of Arrow devs and you can find them on <a href="https://hub.docker.com/r/apache/arrow-dev/tags" class="external-link">the DockerHub repo</a>.</p>
<p>The code below shows an example command you could use to run a Docker container.</p>
<p>This should be run in the root directory of a checkout of the arrow repo.</p>
<pre class="shell"><code>docker run -it -e ARROW_DEPENDENCY_SOURCE=AUTO -v $(pwd):/arrow apache/arrow-dev:r-rhub-ubuntu-gcc-release-latest</code></pre>
<p>Components:</p>
<ul>
<li>
<code>docker run</code> - command to run the container</li>
<li>
<code>-it</code> - run with an interactive terminal so you can run commands on the containers</li>
<li>
<code>-e ARROW_DEPENDENCY_SOURCE=AUTO</code> - set the environment variable <code>ARROW_DEPENDENCY_SOURCE</code> to the value <code>AUTO</code>
</li>
<li>
<code>-v $(pwd):/arrow</code> - mount the current directory at <code>/arrow</code> in the container</li>
<li>
<code>apache/arrow-dev</code> - the DockerHub repo to get this container from</li>
<li>
<code>r-rhub-ubuntu-gcc-release-latest</code> - the image tag</li>
</ul>
<p>Once you run this command, if you don’t have a copy of that particular image saved locally, it will first be downloaded before a container is spun up.</p>
<p>In the example above, mounting the directory in which the Arrow repo was stored on the local machine, meant that that code could be built and tested on the container.</p>
</div>
<div class="section level2">
<h2 id="how-do-i-exit-this-image">How do I exit this image?<a class="anchor" aria-label="anchor" href="#how-do-i-exit-this-image"></a>
</h2>
<p>On Linux, press Ctrl+D.</p>
</div>
<div class="section level2">
<h2 id="how-do-i-show-all-images-saved">How do I show all images saved?<a class="anchor" aria-label="anchor" href="#how-do-i-show-all-images-saved"></a>
</h2>
<pre class="shell"><code>docker images</code></pre>
</div>
<div class="section level2">
<h2 id="how-do-i-show-all-running-containers">How do I show all running containers?<a class="anchor" aria-label="anchor" href="#how-do-i-show-all-running-containers"></a>
</h2>
<pre class="shell"><code>docker ps</code></pre>
</div>
<div class="section level2">
<h2 id="how-do-i-show-all-containers">How do I show all containers?<a class="anchor" aria-label="anchor" href="#how-do-i-show-all-containers"></a>
</h2>
<pre class="shell"><code>sudo docker ps -a</code></pre>
</div>
<div class="section level2">
<h2 id="running-existing-workflows-from-docker-compose-yml">Running existing workflows from docker-compose.yml<a class="anchor" aria-label="anchor" href="#running-existing-workflows-from-docker-compose-yml"></a>
</h2>
<p>There are a number of workflows outlined in the file <code>docker-compose.yml</code> in the arrow repo root directory. For example, you can use the workflow called <code>r</code> to test building and installing the R package. This is advantageous as you can use existing utility scripts and install it onto a container which already has R on it.</p>
<p>These workflows are also parameterized, which means you can specify different options (or just use the defaults, which can be found in <code>.env</code>)</p>
<div class="section level3">
<h3 id="example---the-manual-way">Example - The manual way<a class="anchor" aria-label="anchor" href="#example---the-manual-way"></a>
</h3>
<p>If you wanted to run <a href="https://hub.docker.com/r/rhub/ubuntu-gcc-release" class="external-link">RHub’s latest <code>ubuntu-gcc-release</code> image</a>, you could run:</p>
<pre class="shell"><code>R_ORG=rhub R_IMAGE=ubuntu-gcc-release R_TAG=latest docker-compose build r
R_ORG=rhub R_IMAGE=ubuntu-gcc-release R_TAG=latest docker-compose run r</code></pre>
</div>
<div class="section level3">
<h3 id="example---using-archery">Example - Using Archery<a class="anchor" aria-label="anchor" href="#example---using-archery"></a>
</h3>
<p>Alternatively, you may prefer to use the <a href="https://arrow.apache.org/docs/developers/docker.html" class="external-link">Archery tool to run docker images</a>. This has the advantage of making it simpler to build some of the existing Arrow CI jobs which have hierarchical dependencies, and so for example, you could build the R package on a container which already has the C++ code pre-built.</p>
<p>This is the same tool which our CI uses - via a tool called <a href="https://arrow.apache.org/docs/developers/crossbow.html" class="external-link">Crossbow</a>.</p>
<p>If you want to run the <code>r</code> workflow discussed above, you could run:</p>
<pre class="shell"><code>R_ORG=rhub R_IMAGE=ubuntu-gcc-release R_TAG=latest archery docker run r</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Neal Richardson, Ian Cook, Nic Crane, Jonathan Keane, Romain François, Jeroen Ooms, Apache Arrow.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
