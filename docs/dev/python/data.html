

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Data Types and In-Memory Data Model &#8212; Apache Arrow v21.0.0.dev206</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'python/data';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/docs/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev/';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="canonical" href="https://arrow.apache.org/docs/python/data.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="21.0.0.dev206" />

  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    /* We explicitly disable cookie tracking to avoid privacy issues */
    _paq.push(['disableCookies']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="https://analytics.apache.org/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '20']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/arrow.png" class="logo__image only-light" alt="Apache Arrow v21.0.0.dev206 - Home"/>
    <img src="../_static/arrow-dark.png" class="logo__image only-dark pst-js-only" alt="Apache Arrow v21.0.0.dev206 - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../format/index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../format/index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Data Types and In-Memory Data Model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="data-types-and-in-memory-data-model">
<span id="data"></span><h1>Data Types and In-Memory Data Model<a class="headerlink" href="#data-types-and-in-memory-data-model" title="Permalink to this heading">#</a></h1>
<p>Apache Arrow defines columnar array data structures by composing type metadata
with memory buffers, like the ones explained in the documentation on
<a class="reference internal" href="memory.html#io"><span class="std std-ref">Memory and IO</span></a>. These data structures are exposed in Python through
a series of interrelated classes:</p>
<ul class="simple">
<li><p><strong>Type Metadata</strong>: Instances of <code class="docutils literal notranslate"><span class="pre">pyarrow.DataType</span></code>, which describe the
type of an array and govern how its values are interpreted</p></li>
<li><p><strong>Schemas</strong>: Instances of <code class="docutils literal notranslate"><span class="pre">pyarrow.Schema</span></code>, which describe a named
collection of types. These can be thought of as the column types in a
table-like object.</p></li>
<li><p><strong>Arrays</strong>: Instances of <code class="docutils literal notranslate"><span class="pre">pyarrow.Array</span></code>, which are atomic, contiguous
columnar data structures composed from Arrow Buffer objects</p></li>
<li><p><strong>Record Batches</strong>: Instances of <code class="docutils literal notranslate"><span class="pre">pyarrow.RecordBatch</span></code>, which are a
collection of Array objects with a particular Schema</p></li>
<li><p><strong>Tables</strong>: Instances of <code class="docutils literal notranslate"><span class="pre">pyarrow.Table</span></code>, a logical table data structure in
which each column consists of one or more <code class="docutils literal notranslate"><span class="pre">pyarrow.Array</span></code> objects of the
same type.</p></li>
</ul>
<p>We will examine these in the sections below in a series of examples.</p>
<section id="type-metadata">
<span id="data-types"></span><h2>Type Metadata<a class="headerlink" href="#type-metadata" title="Permalink to this heading">#</a></h2>
<p>Apache Arrow defines language agnostic column-oriented data structures for
array data. These include:</p>
<ul class="simple">
<li><p><strong>Fixed-length primitive types</strong>: numbers, booleans, date and times, fixed
size binary, decimals, and other values that fit into a given number</p></li>
<li><p><strong>Variable-length primitive types</strong>: binary, string</p></li>
<li><p><strong>Nested types</strong>: list, map, struct, and union</p></li>
<li><p><strong>Dictionary type</strong>: An encoded categorical type (more on this later)</p></li>
</ul>
<p>Each data type in Arrow has a corresponding factory function for creating
an instance of that type object in Python:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>

<span class="gp">In [2]: </span><span class="n">t1</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()</span>

<span class="gp">In [3]: </span><span class="n">t2</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>

<span class="gp">In [4]: </span><span class="n">t3</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">binary</span><span class="p">()</span>

<span class="gp">In [5]: </span><span class="n">t4</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">t5</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">timestamp</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">t1</span>
<span class="gh">Out[7]: </span><span class="go">DataType(int32)</span>

<span class="gp">In [8]: </span><span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="go">int32</span>

<span class="gp">In [9]: </span><span class="nb">print</span><span class="p">(</span><span class="n">t4</span><span class="p">)</span>
<span class="go">fixed_size_binary[10]</span>

<span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="n">t5</span><span class="p">)</span>
<span class="go">timestamp[ms]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different data types might use a given physical storage. For example,
<code class="docutils literal notranslate"><span class="pre">int64</span></code>, <code class="docutils literal notranslate"><span class="pre">float64</span></code>, and <code class="docutils literal notranslate"><span class="pre">timestamp[ms]</span></code> all occupy 64 bits per value.</p>
</div>
<p>These objects are <code class="docutils literal notranslate"><span class="pre">metadata</span></code>; they are used for describing the data in arrays,
schemas, and record batches. In Python, they can be used in functions where the
input data (e.g. Python objects) may be coerced to more than one Arrow type.</p>
<p>The <a class="reference internal" href="generated/pyarrow.Field.html#pyarrow.Field" title="pyarrow.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> type is a type plus a name and optional
user-defined metadata:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">f0</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;int32_field&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">f0</span>
<span class="gh">Out[12]: </span><span class="go">pyarrow.Field&lt;int32_field: int32&gt;</span>

<span class="gp">In [13]: </span><span class="n">f0</span><span class="o">.</span><span class="n">name</span>
<span class="gh">Out[13]: </span><span class="go">&#39;int32_field&#39;</span>

<span class="gp">In [14]: </span><span class="n">f0</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[14]: </span><span class="go">DataType(int32)</span>
</pre></div>
</div>
<p>Arrow supports <strong>nested value types</strong> like list, map, struct, and union. When
creating these, you must pass types or fields to indicate the data types of the
types’ children. For example, we can define a list of int32 values with:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">t6</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">list_</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">t6</span>
<span class="gh">Out[16]: </span><span class="go">ListType(list&lt;item: int32&gt;)</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">struct</span></code> is a collection of named fields:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="n">t4</span><span class="p">),</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">t6</span><span class="p">),</span>
<span class="gp">   ....: </span><span class="p">]</span>
<span class="gp">   ....: </span>

<span class="gp">In [18]: </span><span class="n">t7</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="nb">print</span><span class="p">(</span><span class="n">t7</span><span class="p">)</span>
<span class="go">struct&lt;s0: int32, s1: string, s2: fixed_size_binary[10], s3: list&lt;item: int32&gt;&gt;</span>
</pre></div>
</div>
<p>For convenience, you can pass <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">type)</span></code> tuples directly instead of
<a class="reference internal" href="generated/pyarrow.Field.html#pyarrow.Field" title="pyarrow.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code></a> instances:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">t8</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="n">t4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">t6</span><span class="p">)])</span>

<span class="gp">In [21]: </span><span class="nb">print</span><span class="p">(</span><span class="n">t8</span><span class="p">)</span>
<span class="go">struct&lt;s0: int32, s1: string, s2: fixed_size_binary[10], s3: list&lt;item: int32&gt;&gt;</span>

<span class="gp">In [22]: </span><span class="n">t8</span> <span class="o">==</span> <span class="n">t7</span>
<span class="gh">Out[22]: </span><span class="go">True</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="api/datatypes.html#api-types"><span class="std std-ref">Data Types API</span></a> for a full listing of data type
functions.</p>
</section>
<section id="schemas">
<span id="data-schema"></span><h2>Schemas<a class="headerlink" href="#schemas" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference internal" href="generated/pyarrow.Schema.html#pyarrow.Schema" title="pyarrow.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> type is similar to the <code class="docutils literal notranslate"><span class="pre">struct</span></code> array type; it
defines the column names and types in a record batch or table data
structure. The <a class="reference internal" href="generated/pyarrow.schema.html#pyarrow.schema" title="pyarrow.schema"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.schema()</span></code></a> factory function makes new Schema objects in
Python:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">my_schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;field0&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">),</span>
<span class="gp">   ....: </span>                       <span class="p">(</span><span class="s1">&#39;field1&#39;</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span>
<span class="gp">   ....: </span>                       <span class="p">(</span><span class="s1">&#39;field2&#39;</span><span class="p">,</span> <span class="n">t4</span><span class="p">),</span>
<span class="gp">   ....: </span>                       <span class="p">(</span><span class="s1">&#39;field3&#39;</span><span class="p">,</span> <span class="n">t6</span><span class="p">)])</span>
<span class="gp">   ....: </span>

<span class="gp">In [24]: </span><span class="n">my_schema</span>
<span class="gh">Out[24]: </span>
<span class="go">field0: int32</span>
<span class="go">field1: string</span>
<span class="go">field2: fixed_size_binary[10]</span>
<span class="go">field3: list&lt;item: int32&gt;</span>
<span class="go">  child 0, item: int32</span>
</pre></div>
</div>
<p>In some applications, you may not create schemas directly, only using the ones
that are embedded in <a class="reference internal" href="ipc.html#ipc"><span class="std std-ref">IPC messages</span></a>.</p>
<p>Schemas are immutable, which means you can’t update an existing schema, but you
can create a new one with updated values using <a class="reference internal" href="generated/pyarrow.Schema.html#pyarrow.Schema.set" title="pyarrow.Schema.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Schema.set()</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">updated_field</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;field0_new&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())</span>

<span class="gp">In [26]: </span><span class="n">my_schema2</span> <span class="o">=</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">updated_field</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="n">my_schema2</span>
<span class="gh">Out[27]: </span>
<span class="go">field0_new: int64</span>
<span class="go">field1: string</span>
<span class="go">field2: fixed_size_binary[10]</span>
<span class="go">field3: list&lt;item: int32&gt;</span>
<span class="go">  child 0, item: int32</span>
</pre></div>
</div>
</section>
<section id="arrays">
<span id="data-array"></span><h2>Arrays<a class="headerlink" href="#arrays" title="Permalink to this heading">#</a></h2>
<p>For each data type, there is an accompanying array data structure for holding
memory buffers that define a single contiguous chunk of columnar array
data. When you are using PyArrow, this data may come from IPC tools, though it
can also be created from various types of Python sequences (lists, NumPy
arrays, pandas data).</p>
<p>A simple way to create arrays is with <code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code>, which is similar to
the <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> function.  By default PyArrow will infer the data type
for you:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="gp">In [29]: </span><span class="n">arr</span>
<span class="gh">Out[29]: </span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7fbd2a64b6a0&gt;</span>
<span class="go">[</span>
<span class="go">  1,</span>
<span class="go">  2,</span>
<span class="go">  null,</span>
<span class="go">  3</span>
<span class="go">]</span>
</pre></div>
</div>
<p>But you may also pass a specific data type to override type inference:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [30]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">uint16</span><span class="p">())</span>
<span class="gh">Out[30]: </span>
<span class="go">&lt;pyarrow.lib.UInt16Array object at 0x7fbd2a64bb80&gt;</span>
<span class="go">[</span>
<span class="go">  1,</span>
<span class="go">  2</span>
<span class="go">]</span>
</pre></div>
</div>
<p>The array’s <code class="docutils literal notranslate"><span class="pre">type</span></code> attribute is the corresponding piece of type metadata:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [31]: </span><span class="n">arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[31]: </span><span class="go">DataType(int64)</span>
</pre></div>
</div>
<p>Each in-memory array has a known length and null count (which will be 0 if
there are no null values):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gh">Out[32]: </span><span class="go">4</span>

<span class="gp">In [33]: </span><span class="n">arr</span><span class="o">.</span><span class="n">null_count</span>
<span class="gh">Out[33]: </span><span class="go">1</span>
</pre></div>
</div>
<p>Scalar values can be selected with normal indexing.  <code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code> converts
<code class="docutils literal notranslate"><span class="pre">None</span></code> values to Arrow nulls; we return the special <code class="docutils literal notranslate"><span class="pre">pyarrow.NA</span></code> value for
nulls:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[34]: </span><span class="go">&lt;pyarrow.Int64Scalar: 1&gt;</span>

<span class="gp">In [35]: </span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gh">Out[35]: </span><span class="go">&lt;pyarrow.Int64Scalar: None&gt;</span>
</pre></div>
</div>
<p>Arrow data is immutable, so values can be selected but not assigned.</p>
<p>Arrays can be sliced without copying:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [36]: </span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[36]: </span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7fbd2a58c580&gt;</span>
<span class="go">[</span>
<span class="go">  2,</span>
<span class="go">  null</span>
<span class="go">]</span>
</pre></div>
</div>
<section id="none-values-and-nan-handling">
<h3>None values and NAN handling<a class="headerlink" href="#none-values-and-nan-handling" title="Permalink to this heading">#</a></h3>
<p>As mentioned in the above section, the Python object <code class="docutils literal notranslate"><span class="pre">None</span></code> is always
converted to an Arrow null element on the conversion to <code class="docutils literal notranslate"><span class="pre">pyarrow.Array</span></code>. For
the float NaN value which is either represented by the Python object
<code class="docutils literal notranslate"><span class="pre">float('nan')</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code> we normally convert it to a <em>valid</em> float
value during the conversion. If an integer input is supplied to
<code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code> that contains <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<p>To handle better compatibility with Pandas, we support interpreting NaN values as
null elements. This is enabled automatically on all <code class="docutils literal notranslate"><span class="pre">from_pandas</span></code> function and
can be enabled on the other conversion functions by passing <code class="docutils literal notranslate"><span class="pre">from_pandas=True</span></code>
as a function parameter.</p>
</section>
<section id="list-arrays">
<h3>List arrays<a class="headerlink" href="#list-arrays" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code> is able to infer the type of simple nested data structures
like lists:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [37]: </span><span class="n">nested_arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="gp">In [38]: </span><span class="nb">print</span><span class="p">(</span><span class="n">nested_arr</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
<span class="go">list&lt;item: int64&gt;</span>
</pre></div>
</div>
</section>
<section id="listview-arrays">
<h3>ListView arrays<a class="headerlink" href="#listview-arrays" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code> can create an alternate list type called ListView:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">nested_arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">list_view</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">()))</span>

<span class="gp">In [40]: </span><span class="nb">print</span><span class="p">(</span><span class="n">nested_arr</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
<span class="go">list_view&lt;item: int64&gt;</span>
</pre></div>
</div>
<p>ListView arrays have a different set of buffers than List arrays. The ListView array
has both an offsets and sizes buffer, while a List array only has an offsets buffer.
This allows for ListView arrays to specify out-of-order offsets:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="gp">In [42]: </span><span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="gp">In [43]: </span><span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="gp">In [44]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ListViewArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">offsets</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

<span class="gp">In [45]: </span><span class="n">arr</span>
<span class="gh">Out[45]: </span>
<span class="go">&lt;pyarrow.lib.ListViewArray object at 0x7fbd2a58d4e0&gt;</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    5,</span>
<span class="go">    6</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2</span>
<span class="go">  ]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>See the format specification for more details on <a class="reference internal" href="../format/Columnar.html#listview-layout"><span class="std std-ref">ListView Layout</span></a>.</p>
</section>
<section id="struct-arrays">
<h3>Struct arrays<a class="headerlink" href="#struct-arrays" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pyarrow.array</span></code> is able to infer the schema of a struct type from arrays of
dictionaries:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">3.4</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}])</span>
<span class="gh">Out[46]: </span>
<span class="go">&lt;pyarrow.lib.StructArray object at 0x7fbd2a58d840&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- child 0 type: int64</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    4</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    true,</span>
<span class="go">    null</span>
<span class="go">  ]</span>
<span class="go">-- child 2 type: double</span>
<span class="go">  [</span>
<span class="go">    null,</span>
<span class="go">    3.4</span>
<span class="go">  ]</span>
</pre></div>
</div>
<p>Struct arrays can be initialized from a sequence of Python dicts or tuples. For tuples,
you must explicitly pass the type:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [47]: </span><span class="n">ty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">struct</span><span class="p">([(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int8</span><span class="p">()),</span>
<span class="gp">   ....: </span>                <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">bool_</span><span class="p">())])</span>
<span class="gp">   ....: </span>

<span class="gp">In [48]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">ty</span><span class="p">)</span>
<span class="gh">Out[48]: </span>
<span class="go">&lt;pyarrow.lib.StructArray object at 0x7fbd2a58dea0&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- child 0 type: int8</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    true,</span>
<span class="go">    false</span>
<span class="go">  ]</span>

<span class="gp">In [49]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">)],</span> <span class="nb">type</span><span class="o">=</span><span class="n">ty</span><span class="p">)</span>
<span class="gh">Out[49]: </span>
<span class="go">&lt;pyarrow.lib.StructArray object at 0x7fbd2a58dfc0&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- child 0 type: int8</span>
<span class="go">  [</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    true,</span>
<span class="go">    false</span>
<span class="go">  ]</span>
</pre></div>
</div>
<p>When initializing a struct array, nulls are allowed both at the struct
level and at the individual field level.  If initializing from a sequence
of Python dicts, a missing dict key is handled as a null value:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}],</span> <span class="nb">type</span><span class="o">=</span><span class="n">ty</span><span class="p">)</span>
<span class="gh">Out[50]: </span>
<span class="go">&lt;pyarrow.lib.StructArray object at 0x7fbd2a58e020&gt;</span>
<span class="go">-- is_valid:</span>
<span class="go">  [</span>
<span class="go">    true,</span>
<span class="go">    false,</span>
<span class="go">    true</span>
<span class="go">  ]</span>
<span class="go">-- child 0 type: int8</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    0,</span>
<span class="go">    null</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    null,</span>
<span class="go">    false,</span>
<span class="go">    null</span>
<span class="go">  ]</span>
</pre></div>
</div>
<p>You can also construct a struct array from existing arrays for each of the
struct’s components.  In this case, data storage will be shared with the
individual arrays, and no copy is involved:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [51]: </span><span class="n">xs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int16</span><span class="p">())</span>

<span class="gp">In [52]: </span><span class="n">ys</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>

<span class="gp">In [53]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">StructArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">((</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>

<span class="gp">In [54]: </span><span class="n">arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[54]: </span><span class="go">StructType(struct&lt;x: int16, y: bool&gt;)</span>

<span class="gp">In [55]: </span><span class="n">arr</span>
<span class="gh">Out[55]: </span>
<span class="go">&lt;pyarrow.lib.StructArray object at 0x7fbd2a58e800&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- child 0 type: int16</span>
<span class="go">  [</span>
<span class="go">    5,</span>
<span class="go">    6,</span>
<span class="go">    7</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    false,</span>
<span class="go">    true,</span>
<span class="go">    true</span>
<span class="go">  ]</span>
</pre></div>
</div>
</section>
<section id="map-arrays">
<h3>Map arrays<a class="headerlink" href="#map-arrays" title="Permalink to this heading">#</a></h3>
<p>Map arrays can be constructed from lists of lists of tuples (key-item pairs), but only if
the type is explicitly passed into <a class="reference internal" href="generated/pyarrow.array.html#pyarrow.array" title="pyarrow.array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">array()</span></code></a>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [56]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)]]</span>

<span class="gp">In [57]: </span><span class="n">ty</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">map_</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">(),</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())</span>

<span class="gp">In [58]: </span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">ty</span><span class="p">)</span>
<span class="gh">Out[58]: </span>
<span class="go">&lt;pyarrow.lib.MapArray object at 0x7fbd2a58ee00&gt;</span>
<span class="go">[</span>
<span class="go">  keys:</span>
<span class="go">  [</span>
<span class="go">    &quot;x&quot;,</span>
<span class="go">    &quot;y&quot;</span>
<span class="go">  ]</span>
<span class="go">  values:</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    0</span>
<span class="go">  ],</span>
<span class="go">  keys:</span>
<span class="go">  [</span>
<span class="go">    &quot;a&quot;,</span>
<span class="go">    &quot;b&quot;</span>
<span class="go">  ]</span>
<span class="go">  values:</span>
<span class="go">  [</span>
<span class="go">    2,</span>
<span class="go">    45</span>
<span class="go">  ]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>MapArrays can also be constructed from offset, key, and item arrays. Offsets represent the
starting position of each map. Note that the <a class="reference internal" href="generated/pyarrow.MapArray.html#pyarrow.MapArray.keys" title="pyarrow.MapArray.keys"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MapArray.keys</span></code></a> and <a class="reference internal" href="generated/pyarrow.MapArray.html#pyarrow.MapArray.items" title="pyarrow.MapArray.items"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MapArray.items</span></code></a>
properties give the <em>flattened</em> keys and items. To keep the keys and items associated to
their row, use the <a class="reference internal" href="generated/pyarrow.ListArray.html#pyarrow.ListArray.from_arrays" title="pyarrow.ListArray.from_arrays"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ListArray.from_arrays()</span></code></a> constructor with the
<a class="reference internal" href="generated/pyarrow.MapArray.html#pyarrow.MapArray.offsets" title="pyarrow.MapArray.offsets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MapArray.offsets</span></code></a> property.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [59]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">MapArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="gp">In [60]: </span><span class="n">arr</span><span class="o">.</span><span class="n">keys</span>
<span class="gh">Out[60]: </span>
<span class="go">&lt;pyarrow.lib.StringArray object at 0x7fbd2a58f040&gt;</span>
<span class="go">[</span>
<span class="go">  &quot;x&quot;,</span>
<span class="go">  &quot;y&quot;,</span>
<span class="go">  &quot;z&quot;</span>
<span class="go">]</span>

<span class="gp">In [61]: </span><span class="n">arr</span><span class="o">.</span><span class="n">items</span>
<span class="gh">Out[61]: </span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7fbd2a58efe0&gt;</span>
<span class="go">[</span>
<span class="go">  4,</span>
<span class="go">  5,</span>
<span class="go">  6</span>
<span class="go">]</span>

<span class="gp">In [62]: </span><span class="n">pa</span><span class="o">.</span><span class="n">ListArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">offsets</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
<span class="gh">Out[62]: </span>
<span class="go">&lt;pyarrow.lib.ListArray object at 0x7fbd2a58f340&gt;</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    &quot;x&quot;,</span>
<span class="go">    &quot;y&quot;</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    &quot;z&quot;</span>
<span class="go">  ]</span>
<span class="go">]</span>

<span class="gp">In [63]: </span><span class="n">pa</span><span class="o">.</span><span class="n">ListArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">offsets</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
<span class="gh">Out[63]: </span>
<span class="go">&lt;pyarrow.lib.ListArray object at 0x7fbd2a58f220&gt;</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    4,</span>
<span class="go">    5</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    6</span>
<span class="go">  ]</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="union-arrays">
<h3>Union arrays<a class="headerlink" href="#union-arrays" title="Permalink to this heading">#</a></h3>
<p>The union type represents a nested array type where each value can be one
(and only one) of a set of possible types.  There are two possible
storage types for union arrays: sparse and dense.</p>
<p>In a sparse union array, each of the child arrays has the same length
as the resulting union array.  They are adjuncted with a <code class="docutils literal notranslate"><span class="pre">int8</span></code> “types”
array that tells, for each value, from which child array it must be
selected:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">xs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="gp">In [65]: </span><span class="n">ys</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>

<span class="gp">In [66]: </span><span class="n">types</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int8</span><span class="p">())</span>

<span class="gp">In [67]: </span><span class="n">union_arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">UnionArray</span><span class="o">.</span><span class="n">from_sparse</span><span class="p">(</span><span class="n">types</span><span class="p">,</span> <span class="p">[</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">])</span>

<span class="gp">In [68]: </span><span class="n">union_arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[68]: </span><span class="go">SparseUnionType(sparse_union&lt;0: int64=0, 1: bool=1&gt;)</span>

<span class="gp">In [69]: </span><span class="n">union_arr</span>
<span class="gh">Out[69]: </span>
<span class="go">&lt;pyarrow.lib.UnionArray object at 0x7fbd2a58e740&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- type_ids:   [</span>
<span class="go">    0,</span>
<span class="go">    1,</span>
<span class="go">    1</span>
<span class="go">  ]</span>
<span class="go">-- child 0 type: int64</span>
<span class="go">  [</span>
<span class="go">    5,</span>
<span class="go">    6,</span>
<span class="go">    7</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    false,</span>
<span class="go">    false,</span>
<span class="go">    true</span>
<span class="go">  ]</span>
</pre></div>
</div>
<p>In a dense union array, you also pass, in addition to the <code class="docutils literal notranslate"><span class="pre">int8</span></code> “types”
array, a <code class="docutils literal notranslate"><span class="pre">int32</span></code> “offsets” array that tells, for each value, at
each offset in the selected child array it can be found:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [70]: </span><span class="n">xs</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="gp">In [71]: </span><span class="n">ys</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>

<span class="gp">In [72]: </span><span class="n">types</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int8</span><span class="p">())</span>

<span class="gp">In [73]: </span><span class="n">offsets</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">())</span>

<span class="gp">In [74]: </span><span class="n">union_arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">UnionArray</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">types</span><span class="p">,</span> <span class="n">offsets</span><span class="p">,</span> <span class="p">[</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">])</span>

<span class="gp">In [75]: </span><span class="n">union_arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[75]: </span><span class="go">DenseUnionType(dense_union&lt;0: int64=0, 1: bool=1&gt;)</span>

<span class="gp">In [76]: </span><span class="n">union_arr</span>
<span class="gh">Out[76]: </span>
<span class="go">&lt;pyarrow.lib.UnionArray object at 0x7fbd2a5d0220&gt;</span>
<span class="go">-- is_valid: all not null</span>
<span class="go">-- type_ids:   [</span>
<span class="go">    0,</span>
<span class="go">    1,</span>
<span class="go">    1,</span>
<span class="go">    0,</span>
<span class="go">    0</span>
<span class="go">  ]</span>
<span class="go">-- value_offsets:   [</span>
<span class="go">    0,</span>
<span class="go">    0,</span>
<span class="go">    1,</span>
<span class="go">    1,</span>
<span class="go">    2</span>
<span class="go">  ]</span>
<span class="go">-- child 0 type: int64</span>
<span class="go">  [</span>
<span class="go">    5,</span>
<span class="go">    6,</span>
<span class="go">    7</span>
<span class="go">  ]</span>
<span class="go">-- child 1 type: bool</span>
<span class="go">  [</span>
<span class="go">    false,</span>
<span class="go">    true</span>
<span class="go">  ]</span>
</pre></div>
</div>
</section>
<section id="dictionary-arrays">
<span id="data-dictionary"></span><h3>Dictionary Arrays<a class="headerlink" href="#dictionary-arrays" title="Permalink to this heading">#</a></h3>
<p>The <strong>Dictionary</strong> type in PyArrow is a special array type that is similar to a
factor in R or a <code class="docutils literal notranslate"><span class="pre">pandas.Categorical</span></code>. It enables one or more record batches
in a file or stream to transmit integer <em>indices</em> referencing a shared
<strong>dictionary</strong> containing the distinct values in the logical array. This is
particularly often used with strings to save memory and improve performance.</p>
<p>The way that dictionaries are handled in the Apache Arrow format and the way
they appear in C++ and Python is slightly different. We define a special
<a class="reference internal" href="generated/pyarrow.DictionaryArray.html#pyarrow.DictionaryArray" title="pyarrow.DictionaryArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictionaryArray</span></code></a> type with a corresponding dictionary type. Let’s
consider an example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [77]: </span><span class="n">indices</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="gp">In [78]: </span><span class="n">dictionary</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">])</span>

<span class="gp">In [79]: </span><span class="n">dict_array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">DictionaryArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>

<span class="gp">In [80]: </span><span class="n">dict_array</span>
<span class="gh">Out[80]: </span>
<span class="go">&lt;pyarrow.lib.DictionaryArray object at 0x7fbd2a596ff0&gt;</span>

<span class="go">-- dictionary:</span>
<span class="go">  [</span>
<span class="go">    &quot;foo&quot;,</span>
<span class="go">    &quot;bar&quot;,</span>
<span class="go">    &quot;baz&quot;</span>
<span class="go">  ]</span>
<span class="go">-- indices:</span>
<span class="go">  [</span>
<span class="go">    0,</span>
<span class="go">    1,</span>
<span class="go">    0,</span>
<span class="go">    1,</span>
<span class="go">    2,</span>
<span class="go">    0,</span>
<span class="go">    null,</span>
<span class="go">    2</span>
<span class="go">  ]</span>
</pre></div>
</div>
<p>Here we have:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [81]: </span><span class="nb">print</span><span class="p">(</span><span class="n">dict_array</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
<span class="go">dictionary&lt;values=string, indices=int64, ordered=0&gt;</span>

<span class="gp">In [82]: </span><span class="n">dict_array</span><span class="o">.</span><span class="n">indices</span>
<span class="gh">Out[82]: </span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7fbd2a5d0c40&gt;</span>
<span class="go">[</span>
<span class="go">  0,</span>
<span class="go">  1,</span>
<span class="go">  0,</span>
<span class="go">  1,</span>
<span class="go">  2,</span>
<span class="go">  0,</span>
<span class="go">  null,</span>
<span class="go">  2</span>
<span class="go">]</span>

<span class="gp">In [83]: </span><span class="n">dict_array</span><span class="o">.</span><span class="n">dictionary</span>
<span class="gh">Out[83]: </span>
<span class="go">&lt;pyarrow.lib.StringArray object at 0x7fbd2a5d0d60&gt;</span>
<span class="go">[</span>
<span class="go">  &quot;foo&quot;,</span>
<span class="go">  &quot;bar&quot;,</span>
<span class="go">  &quot;baz&quot;</span>
<span class="go">]</span>
</pre></div>
</div>
<p>When using <a class="reference internal" href="generated/pyarrow.DictionaryArray.html#pyarrow.DictionaryArray" title="pyarrow.DictionaryArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictionaryArray</span></code></a> with pandas, the analogue is
<code class="docutils literal notranslate"><span class="pre">pandas.Categorical</span></code> (more on this later):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [84]: </span><span class="n">dict_array</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="gh">Out[84]: </span>
<span class="go">0    foo</span>
<span class="go">1    bar</span>
<span class="go">2    foo</span>
<span class="go">3    bar</span>
<span class="go">4    baz</span>
<span class="go">5    foo</span>
<span class="go">6    NaN</span>
<span class="go">7    baz</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;foo&#39;, &#39;bar&#39;, &#39;baz&#39;]</span>
</pre></div>
</div>
</section>
</section>
<section id="record-batches">
<span id="data-record-batch"></span><h2>Record Batches<a class="headerlink" href="#record-batches" title="Permalink to this heading">#</a></h2>
<p>A <strong>Record Batch</strong> in Apache Arrow is a collection of equal-length array
instances. Let’s consider a collection of arrays:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [85]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span>
<span class="gp">   ....: </span>    <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">   ....: </span><span class="p">]</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>A record batch can be created from this list of arrays using
<code class="docutils literal notranslate"><span class="pre">RecordBatch.from_arrays</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [86]: </span><span class="n">batch</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;f2&#39;</span><span class="p">])</span>

<span class="gp">In [87]: </span><span class="n">batch</span><span class="o">.</span><span class="n">num_columns</span>
<span class="gh">Out[87]: </span><span class="go">3</span>

<span class="gp">In [88]: </span><span class="n">batch</span><span class="o">.</span><span class="n">num_rows</span>
<span class="gh">Out[88]: </span><span class="go">4</span>

<span class="gp">In [89]: </span><span class="n">batch</span><span class="o">.</span><span class="n">schema</span>
<span class="gh">Out[89]: </span>
<span class="go">f0: int64</span>
<span class="go">f1: string</span>
<span class="go">f2: bool</span>

<span class="gp">In [90]: </span><span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[90]: </span>
<span class="go">&lt;pyarrow.lib.StringArray object at 0x7fbd2a5d13c0&gt;</span>
<span class="go">[</span>
<span class="go">  &quot;foo&quot;,</span>
<span class="go">  &quot;bar&quot;,</span>
<span class="go">  &quot;baz&quot;,</span>
<span class="go">  null</span>
<span class="go">]</span>
</pre></div>
</div>
<p>A record batch can be sliced without copying memory like an array:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [91]: </span><span class="n">batch2</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="gp">In [92]: </span><span class="n">batch2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[92]: </span>
<span class="go">&lt;pyarrow.lib.StringArray object at 0x7fbd2a5d1600&gt;</span>
<span class="go">[</span>
<span class="go">  &quot;bar&quot;,</span>
<span class="go">  &quot;baz&quot;,</span>
<span class="go">  null</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="tables">
<span id="data-table"></span><h2>Tables<a class="headerlink" href="#tables" title="Permalink to this heading">#</a></h2>
<p>The PyArrow <a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table" title="pyarrow.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> type is not part of the Apache Arrow
specification, but is rather a tool to help with wrangling multiple record
batches and array pieces as a single logical dataset. As a relevant example, we
may receive multiple small record batches in a socket stream, then need to
concatenate them into contiguous memory for use in NumPy or pandas. The Table
object makes this efficient without requiring additional memory copying.</p>
<p>Considering the record batch we created above, we can create a Table containing
one or more copies of the batch using <code class="docutils literal notranslate"><span class="pre">Table.from_batches</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [93]: </span><span class="n">batches</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>

<span class="gp">In [94]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_batches</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span>

<span class="gp">In [95]: </span><span class="n">table</span>
<span class="gh">Out[95]: </span>
<span class="go">pyarrow.Table</span>
<span class="go">f0: int64</span>
<span class="go">f1: string</span>
<span class="go">f2: bool</span>
<span class="gt">----</span>
<span class="ne">f0</span>: [[1,2,3,4],[1,2,3,4],...,[1,2,3,4],[1,2,3,4]]
<span class="ne">f1</span>: [[&quot;foo&quot;,&quot;bar&quot;,&quot;baz&quot;,null],[&quot;foo&quot;,&quot;bar&quot;,&quot;baz&quot;,null],...,[&quot;foo&quot;,&quot;bar&quot;,&quot;baz&quot;,null],[&quot;foo&quot;,&quot;bar&quot;,&quot;baz&quot;,null]]
<span class="ne">f2</span>: [[true,null,false,true],[true,null,false,true],...,[true,null,false,true],[true,null,false,true]]

<span class="gp">In [96]: </span><span class="n">table</span><span class="o">.</span><span class="n">num_rows</span>
<span class="gh">Out[96]: </span><span class="go">20</span>
</pre></div>
</div>
<p>The table’s columns are instances of <a class="reference internal" href="generated/pyarrow.ChunkedArray.html#pyarrow.ChunkedArray" title="pyarrow.ChunkedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChunkedArray</span></code></a>, which is a
container for one or more arrays of the same type.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [97]: </span><span class="n">c</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [98]: </span><span class="n">c</span>
<span class="gh">Out[98]: </span>
<span class="go">&lt;pyarrow.lib.ChunkedArray object at 0x7fbd2a5d2200&gt;</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2,</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2,</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ],</span>
<span class="go">...,</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2,</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ],</span>
<span class="go">  [</span>
<span class="go">    1,</span>
<span class="go">    2,</span>
<span class="go">    3,</span>
<span class="go">    4</span>
<span class="go">  ]</span>
<span class="go">]</span>

<span class="gp">In [99]: </span><span class="n">c</span><span class="o">.</span><span class="n">num_chunks</span>
<span class="gh">Out[99]: </span><span class="go">5</span>

<span class="gp">In [100]: </span><span class="n">c</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[100]: </span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7fbd2a5d2440&gt;</span>
<span class="go">[</span>
<span class="go">  1,</span>
<span class="go">  2,</span>
<span class="go">  3,</span>
<span class="go">  4</span>
<span class="go">]</span>
</pre></div>
</div>
<p>As you’ll see in the <a class="reference internal" href="pandas.html#pandas-interop"><span class="std std-ref">pandas section</span></a>, we can convert
these objects to contiguous NumPy arrays for use in pandas:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [101]: </span><span class="n">c</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="gh">Out[101]: </span>
<span class="go">0     1</span>
<span class="go">1     2</span>
<span class="go">2     3</span>
<span class="go">3     4</span>
<span class="go">4     1</span>
<span class="go">5     2</span>
<span class="go">6     3</span>
<span class="go">7     4</span>
<span class="go">8     1</span>
<span class="go">9     2</span>
<span class="go">10    3</span>
<span class="go">11    4</span>
<span class="go">12    1</span>
<span class="go">13    2</span>
<span class="go">14    3</span>
<span class="go">15    4</span>
<span class="go">16    1</span>
<span class="go">17    2</span>
<span class="go">18    3</span>
<span class="go">19    4</span>
<span class="go">Name: f0, dtype: int64</span>
</pre></div>
</div>
<p>Multiple tables can also be concatenated together to form a single table using
<code class="docutils literal notranslate"><span class="pre">pyarrow.concat_tables</span></code>, if the schemas are equal:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [102]: </span><span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

<span class="gp">In [103]: </span><span class="n">table_all</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">concat_tables</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>

<span class="gp">In [104]: </span><span class="n">table_all</span><span class="o">.</span><span class="n">num_rows</span>
<span class="gh">Out[104]: </span><span class="go">40</span>

<span class="gp">In [105]: </span><span class="n">c</span> <span class="o">=</span> <span class="n">table_all</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [106]: </span><span class="n">c</span><span class="o">.</span><span class="n">num_chunks</span>
<span class="gh">Out[106]: </span><span class="go">10</span>
</pre></div>
</div>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">Table.from_batches</span></code>, but uses tables as input instead of
record batches. Record batches can be made into tables, but not the other way
around, so if your data is already in table form, then use
<code class="docutils literal notranslate"><span class="pre">pyarrow.concat_tables</span></code>.</p>
</section>
<section id="custom-schema-and-field-metadata">
<h2>Custom Schema and Field Metadata<a class="headerlink" href="#custom-schema-and-field-metadata" title="Permalink to this heading">#</a></h2>
<p>Arrow supports both schema-level and field-level custom key-value metadata
allowing for systems to insert their own application defined metadata to
customize behavior.</p>
<p>Custom metadata can be accessed at <a class="reference internal" href="generated/pyarrow.Schema.html#pyarrow.Schema.metadata" title="pyarrow.Schema.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Schema.metadata</span></code></a> for the schema-level
and <a class="reference internal" href="generated/pyarrow.Field.html#pyarrow.Field.metadata" title="pyarrow.Field.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Field.metadata</span></code></a> for the field-level.</p>
<p>Note that this metadata is preserved in <a class="reference internal" href="ipc.html#ipc"><span class="std std-ref">Streaming, Serialization, and IPC</span></a> processes.</p>
<p>To customize the schema metadata of an existing table you can use
<a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.replace_schema_metadata" title="pyarrow.Table.replace_schema_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.replace_schema_metadata()</span></code></a>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [107]: </span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">metadata</span> <span class="c1"># empty</span>

<span class="gp">In [108]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">replace_schema_metadata</span><span class="p">({</span><span class="s2">&quot;f0&quot;</span><span class="p">:</span> <span class="s2">&quot;First dose&quot;</span><span class="p">})</span>

<span class="gp">In [109]: </span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">metadata</span>
<span class="gh">Out[109]: </span><span class="go">{b&#39;f0&#39;: b&#39;First dose&#39;}</span>
</pre></div>
</div>
<p>To customize the metadata of the field from the table schema you can use
<a class="reference internal" href="generated/pyarrow.Field.html#pyarrow.Field.with_metadata" title="pyarrow.Field.with_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Field.with_metadata()</span></code></a>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [110]: </span><span class="n">field_f1</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">)</span>

<span class="gp">In [111]: </span><span class="n">field_f1</span><span class="o">.</span><span class="n">metadata</span> <span class="c1"># empty</span>

<span class="gp">In [112]: </span><span class="n">field_f1</span> <span class="o">=</span> <span class="n">field_f1</span><span class="o">.</span><span class="n">with_metadata</span><span class="p">({</span><span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="s2">&quot;Second dose&quot;</span><span class="p">})</span>

<span class="gp">In [113]: </span><span class="n">field_f1</span><span class="o">.</span><span class="n">metadata</span>
<span class="gh">Out[113]: </span><span class="go">{b&#39;f1&#39;: b&#39;Second dose&#39;}</span>
</pre></div>
</div>
<p>Both options create a shallow copy of the data and do not in fact change the
Schema which is immutable. To change the metadata in the schema of the table
we created a new object when calling <a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.replace_schema_metadata" title="pyarrow.Table.replace_schema_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.replace_schema_metadata()</span></code></a>.</p>
<p>To change the metadata of the field in the schema we would need to define
a new schema and cast the data to this schema:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [114]: </span><span class="n">my_schema2</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([</span>
<span class="gp">   .....: </span>   <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">(),</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;First dose&quot;</span><span class="p">}),</span>
<span class="gp">   .....: </span>   <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">(),</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Second dose&quot;</span><span class="p">}),</span>
<span class="gp">   .....: </span>   <span class="n">pa</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;f2&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">bool_</span><span class="p">())],</span>
<span class="gp">   .....: </span>   <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f2&quot;</span><span class="p">:</span> <span class="s2">&quot;booster&quot;</span><span class="p">})</span>
<span class="gp">   .....: </span>

<span class="gp">In [115]: </span><span class="n">t2</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">my_schema2</span><span class="p">)</span>

<span class="gp">In [116]: </span><span class="n">t2</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;f0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span>
<span class="gh">Out[116]: </span><span class="go">{b&#39;name&#39;: b&#39;First dose&#39;}</span>

<span class="gp">In [117]: </span><span class="n">t2</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span>
<span class="gh">Out[117]: </span><span class="go">{b&#39;name&#39;: b&#39;Second dose&#39;}</span>

<span class="gp">In [118]: </span><span class="n">t2</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">metadata</span>
<span class="gh">Out[118]: </span><span class="go">{b&#39;f2&#39;: b&#39;booster&#39;}</span>
</pre></div>
</div>
<p>Metadata key and value pairs are <code class="docutils literal notranslate"><span class="pre">std::string</span></code> objects in the C++ implementation
and so they are bytes objects (<code class="docutils literal notranslate"><span class="pre">b'...'</span></code>) in Python.</p>
</section>
<section id="record-batch-readers">
<h2>Record Batch Readers<a class="headerlink" href="#record-batch-readers" title="Permalink to this heading">#</a></h2>
<p>Many functions in PyArrow either return or take as an argument a <a class="reference internal" href="generated/pyarrow.RecordBatchReader.html#pyarrow.RecordBatchReader" title="pyarrow.RecordBatchReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecordBatchReader</span></code></a>.
It can be used like any iterable of record batches, but also provides their common
schema without having to get any of the batches.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">iter_record_batches</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">yield</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])],</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="o">.</span><span class="n">from_batches</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">iter_record_batches</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
<span class="go">pyarrow.Schema</span>
<span class="go">x: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">pyarrow.RecordBatch</span>
<span class="go">x: int64</span>
<span class="go">pyarrow.RecordBatch</span>
<span class="go">x: int64</span>
</pre></div>
</div>
<p>It can also be sent between languages using the <a class="reference internal" href="../format/CStreamInterface.html#c-stream-interface"><span class="std std-ref">C stream interface</span></a>.</p>
</section>
<section id="conversion-of-recordbatch-to-tensor">
<h2>Conversion of RecordBatch to Tensor<a class="headerlink" href="#conversion-of-recordbatch-to-tensor" title="Permalink to this heading">#</a></h2>
<p>Each array of the <code class="docutils literal notranslate"><span class="pre">RecordBatch</span></code> has it’s own contiguous memory that is not necessarily
adjacent to other arrays. A different memory structure that is used in machine learning
libraries is a two dimensional array (also called a 2-dim tensor or a matrix) which takes
only one contiguous block of memory.</p>
<p>For this reason there is a function <code class="docutils literal notranslate"><span class="pre">pyarrow.RecordBatch.to_tensor()</span></code> available
to efficiently convert tabular columnar data into a tensor.</p>
<p>Data types supported in this conversion are unsigned, signed integer and float
types. Currently only column-major conversion is supported.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">arr2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">batch</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
<span class="gp">... </span>     <span class="p">[</span>
<span class="gp">... </span>         <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">uint16</span><span class="p">()),</span>
<span class="gp">... </span>         <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int16</span><span class="p">()),</span>
<span class="gp">... </span>     <span class="p">],</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">batch</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">()</span>
<span class="go">&lt;pyarrow.Tensor&gt;</span>
<span class="go">type: int32</span>
<span class="go">shape: (9, 2)</span>
<span class="go">strides: (4, 36)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">batch</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="go">array([[ 1, 10],</span>
<span class="go">      [ 2, 20],</span>
<span class="go">      [ 3, 30],</span>
<span class="go">      [ 4, 40],</span>
<span class="go">      [ 5, 50]], dtype=int32)</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">null_to_nan</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code> one can also convert data with
nulls. They will be converted to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">record_batch</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">()),</span>
<span class="gp">... </span>        <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">float32</span><span class="p">()),</span>
<span class="gp">... </span>    <span class="p">],</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">(</span><span class="n">null_to_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="go">array([[ 1., 10.],</span>
<span class="go">      [ 2., 20.],</span>
<span class="go">      [ 3., 30.],</span>
<span class="go">      [ 4., 40.],</span>
<span class="go">      [nan, nan]])</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#type-metadata">Type Metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#schemas">Schemas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays">Arrays</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#none-values-and-nan-handling">None values and NAN handling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#list-arrays">List arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#listview-arrays">ListView arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#struct-arrays">Struct arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#map-arrays">Map arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#union-arrays">Union arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dictionary-arrays">Dictionary Arrays</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#record-batches">Record Batches</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tables">Tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-schema-and-field-metadata">Custom Schema and Field Metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#record-batch-readers">Record Batch Readers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conversion-of-recordbatch-to-tensor">Conversion of RecordBatch to Tensor</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/apache/arrow/edit/main/docs/source/python/data.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2016-2025 Apache Software Foundation.
Apache Arrow, Arrow, Apache, the Apache feather logo, and the Apache Arrow project logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>