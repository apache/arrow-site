

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Pandas Integration &#8212; Apache Arrow v21.0.0.dev206</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'python/pandas';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/docs/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev/';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="canonical" href="https://arrow.apache.org/docs/python/pandas.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="21.0.0.dev206" />

  <!-- Matomo -->
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    /* We explicitly disable cookie tracking to avoid privacy issues */
    _paq.push(['disableCookies']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
      var u="https://analytics.apache.org/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '20']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  </script>
  <!-- End Matomo Code -->

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/arrow.png" class="logo__image only-light" alt="Apache Arrow v21.0.0.dev206 - Home"/>
    <img src="../_static/arrow-dark.png" class="logo__image only-dark pst-js-only" alt="Apache Arrow v21.0.0.dev206 - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../format/index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../format/index.html">
    Specifications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../implementations.html">
    Implementations
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div class="kapa-ai-bot">
    <script
        async
        src="https://widget.kapa.ai/kapa-widget.bundle.js"
        data-website-id="9db461d5-ac77-4b3f-a5c5-75efa78339d2"
        data-project-name="Apache Arrow"
        data-project-color="#000000"
        data-project-logo="https://arrow.apache.org/img/arrow-logo_chevrons_white-txt_black-bg.png"
        data-modal-disclaimer="This is a custom LLM with access to all [Arrow documentation](https://arrow.apache.org/docs/). Please include the language you are using in your question, e.g., Python, C++, Java, R, etc."
        data-consent-required="true" 
        data-consent-screen-disclaimer="By clicking &quot;I agree, let's chat&quot;, you consent to the use of the AI assistant in accordance with kapa.ai's [Privacy Policy](https://www.kapa.ai/content/privacy-policy). This service uses reCAPTCHA, which requires your consent to Google's [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms). By proceeding, you explicitly agree to both kapa.ai's and Google's privacy policies."
    ></script>
   
</div>

</div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/apache/arrow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/apache-arrow/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/arrow.apache.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Pandas Integration</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pandas-integration">
<span id="pandas-interop"></span><h1>Pandas Integration<a class="headerlink" href="#pandas-integration" title="Permalink to this heading">#</a></h1>
<p>To interface with <a class="reference external" href="https://pandas.pydata.org/">pandas</a>, PyArrow provides
various conversion routines to consume pandas structures and convert back
to them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While pandas uses NumPy as a backend, it has enough peculiarities
(such as a different type system, and support for null values) that this
is a separate topic from <a class="reference internal" href="numpy.html#numpy-interop"><span class="std std-ref">NumPy Integration</span></a>.</p>
</div>
<p>To follow examples in this document, make sure to run:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="gp">In [2]: </span><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
</pre></div>
</div>
<section id="dataframes">
<h2>DataFrames<a class="headerlink" href="#dataframes" title="Permalink to this heading">#</a></h2>
<p>The equivalent to a pandas DataFrame in Arrow is a <a class="reference internal" href="data.html#data-table"><span class="std std-ref">Table</span></a>.
Both consist of a set of named columns of equal length. While pandas only
supports flat columns, the Table also provides nested columns, thus it can
represent more data than a DataFrame, so a full conversion is not always possible.</p>
<p>Conversion from a Table to a DataFrame is done by calling
<a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.to_pandas" title="pyarrow.Table.to_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyarrow.Table.to_pandas()</span></code></a>. The inverse is then achieved by using
<a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.from_pandas" title="pyarrow.Table.from_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyarrow.Table.from_pandas()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pa</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="c1"># Convert from pandas to Arrow</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># Convert back to pandas</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Infer Arrow schema from pandas</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Schema</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> tries to preserve and restore the <code class="docutils literal notranslate"><span class="pre">.index</span></code>
data as accurately as possible. See the section below for more about
this, and how to disable this logic.</p>
</section>
<section id="series">
<h2>Series<a class="headerlink" href="#series" title="Permalink to this heading">#</a></h2>
<p>In Arrow, the most similar structure to a pandas Series is an Array.
It is a vector that contains data of the same type as linear memory. You can
convert a pandas Series to an Arrow Array using <a class="reference internal" href="generated/pyarrow.Array.html#pyarrow.Array.from_pandas" title="pyarrow.Array.from_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyarrow.Array.from_pandas()</span></code></a>.
As Arrow Arrays are always nullable, you can supply an optional mask using
the <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter to mark all null-entries.</p>
</section>
<section id="handling-pandas-indexes">
<h2>Handling pandas Indexes<a class="headerlink" href="#handling-pandas-indexes" title="Permalink to this heading">#</a></h2>
<p>Methods like <a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.from_pandas" title="pyarrow.Table.from_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyarrow.Table.from_pandas()</span></code></a> have a
<code class="docutils literal notranslate"><span class="pre">preserve_index</span></code> option which defines how to preserve (store) or not
to preserve (to not store) the data in the <code class="docutils literal notranslate"><span class="pre">index</span></code> member of the
corresponding pandas object. This data is tracked using schema-level
metadata in the internal <code class="docutils literal notranslate"><span class="pre">arrow::Schema</span></code> object.</p>
<p>The default of <code class="docutils literal notranslate"><span class="pre">preserve_index</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which behaves as
follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RangeIndex</span></code> is stored as metadata-only, not requiring any extra
storage.</p></li>
<li><p>Other index types are stored as one or more physical data columns in
the resulting <code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></p></li>
</ul>
<p>To not store the index at all pass <code class="docutils literal notranslate"><span class="pre">preserve_index=False</span></code>. Since
storing a <code class="docutils literal notranslate"><span class="pre">RangeIndex</span></code> can cause issues in some limited scenarios
(such as storing multiple DataFrame objects in a Parquet file), to
force all index data to be serialized in the resulting table, pass
<code class="docutils literal notranslate"><span class="pre">preserve_index=True</span></code>.</p>
</section>
<section id="type-differences">
<h2>Type differences<a class="headerlink" href="#type-differences" title="Permalink to this heading">#</a></h2>
<p>With the current design of pandas and Arrow, it is not possible to convert all
column types unmodified. One of the main issues here is that pandas has no
support for nullable columns of arbitrary type. Also <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> is currently
fixed to nanosecond resolution. On the other side, Arrow might be still missing
support for some types.</p>
<section id="pandas-arrow-conversion">
<h3>pandas -&gt; Arrow Conversion<a class="headerlink" href="#pandas-arrow-conversion" title="Permalink to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Source Type (pandas)</p></th>
<th class="head"><p>Destination Type (Arrow)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOL</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(u)int{8,16,32,64}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(U)INT{8,16,32,64}</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str</span></code> / <code class="docutils literal notranslate"><span class="pre">unicode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.Categorical</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DICTIONARY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.Timestamp</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(unit=ns)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">datetime.date</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">datetime.time</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIME64</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="arrow-pandas-conversion">
<h3>Arrow -&gt; pandas Conversion<a class="headerlink" href="#arrow-pandas-conversion" title="Permalink to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Source Type (Arrow)</p></th>
<th class="head"><p>Destination Type (pandas)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BOOL</span></code> <em>with nulls</em></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">object</span></code> (with values <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(U)INT{8,16,32,64}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(u)int{8,16,32,64}</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(U)INT{8,16,32,64}</span></code> <em>with nulls</em></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DICTIONARY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pd.Categorical</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP(unit=*)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pd.Timestamp</span></code> (<code class="docutils literal notranslate"><span class="pre">np.datetime64[ns]</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">object</span></code> (with <code class="docutils literal notranslate"><span class="pre">datetime.date</span></code> objects)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIME64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">object</span></code> (with <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> objects)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="categorical-types">
<h3>Categorical types<a class="headerlink" href="#categorical-types" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html">Pandas categorical</a>
columns are converted to <a class="reference internal" href="data.html#data-dictionary"><span class="std std-ref">Arrow dictionary arrays</span></a>,
a special array type optimized to handle repeated and limited
number of possible values.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;cat&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])})</span>

<span class="gp">In [4]: </span><span class="n">df</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">categories</span>
<span class="gh">Out[4]: </span><span class="go">Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">In [5]: </span><span class="n">df</span>
<span class="gh">Out[5]: </span>
<span class="go">  cat</span>
<span class="go">0   a</span>
<span class="go">1   b</span>
<span class="go">2   c</span>
<span class="go">3   a</span>
<span class="go">4   b</span>
<span class="go">5   c</span>

<span class="gp">In [6]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">table</span>
<span class="gh">Out[7]: </span>
<span class="go">pyarrow.Table</span>
<span class="go">cat: dictionary&lt;values=string, indices=int8, ordered=0&gt;</span>
<span class="gt">----</span>
<span class="ne">cat</span>: [  -- dictionary:
<span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>  <span class="o">--</span> <span class="n">indices</span><span class="p">:</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
<p>We can inspect the <a class="reference internal" href="generated/pyarrow.ChunkedArray.html#pyarrow.ChunkedArray" title="pyarrow.ChunkedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChunkedArray</span></code></a> of the created table and see the
same categories of the Pandas DataFrame.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">column</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [9]: </span><span class="n">chunk</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">chunk</span><span class="o">.</span><span class="n">dictionary</span>
<span class="gh">Out[10]: </span>
<span class="go">&lt;pyarrow.lib.StringArray object at 0x7fbcf9a679a0&gt;</span>
<span class="go">[</span>
<span class="go">  &quot;a&quot;,</span>
<span class="go">  &quot;b&quot;,</span>
<span class="go">  &quot;c&quot;</span>
<span class="go">]</span>

<span class="gp">In [11]: </span><span class="n">chunk</span><span class="o">.</span><span class="n">indices</span>
<span class="gh">Out[11]: </span>
<span class="go">&lt;pyarrow.lib.Int8Array object at 0x7fbcf9a675e0&gt;</span>
<span class="go">[</span>
<span class="go">  0,</span>
<span class="go">  1,</span>
<span class="go">  2,</span>
<span class="go">  0,</span>
<span class="go">  1,</span>
<span class="go">  2</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="datetime-timestamp-types">
<h3>Datetime (Timestamp) types<a class="headerlink" href="#datetime-timestamp-types" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html">Pandas Timestamps</a>
use the <code class="docutils literal notranslate"><span class="pre">datetime64[ns]</span></code> type in Pandas and are converted to an Arrow
<a class="reference internal" href="generated/pyarrow.TimestampArray.html#pyarrow.TimestampArray" title="pyarrow.TimestampArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimestampArray</span></code></a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-01-01T00:00:00Z&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)})</span>

<span class="gp">In [13]: </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[13]: </span>
<span class="go">datetime    datetime64[ns, UTC]</span>
<span class="go">dtype: object</span>

<span class="gp">In [14]: </span><span class="n">df</span>
<span class="gh">Out[14]: </span>
<span class="go">                   datetime</span>
<span class="go">0 2020-01-01 00:00:00+00:00</span>
<span class="go">1 2020-01-01 01:00:00+00:00</span>
<span class="go">2 2020-01-01 02:00:00+00:00</span>

<span class="gp">In [15]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">table</span>
<span class="gh">Out[16]: </span>
<span class="go">pyarrow.Table</span>
<span class="go">datetime: timestamp[ns, tz=UTC]</span>
<span class="gt">----</span>
<span class="ne">datetime</span>: [[2020-01-01 00:00:00.000000000Z,2020-01-01 01:00:00.000000000Z,2020-01-01 02:00:00.000000000Z]]
</pre></div>
</div>
<p>In this example the Pandas Timestamp is time zone aware
(<code class="docutils literal notranslate"><span class="pre">UTC</span></code> on this case), and this information is used to create the Arrow
<a class="reference internal" href="generated/pyarrow.TimestampArray.html#pyarrow.TimestampArray" title="pyarrow.TimestampArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimestampArray</span></code></a>.</p>
</section>
<section id="date-types">
<h3>Date types<a class="headerlink" href="#date-types" title="Permalink to this heading">#</a></h3>
<p>While dates can be handled using the <code class="docutils literal notranslate"><span class="pre">datetime64[ns]</span></code> type in
pandas, some systems work with object arrays of Python’s built-in
<code class="docutils literal notranslate"><span class="pre">datetime.date</span></code> object:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span>

<span class="gp">In [18]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

<span class="gp">In [19]: </span><span class="n">s</span>
<span class="gh">Out[19]: </span>
<span class="go">0    2018-12-31</span>
<span class="go">1          None</span>
<span class="go">2    2000-01-01</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>When converting to an Arrow array, the <code class="docutils literal notranslate"><span class="pre">date32</span></code> type will be used by
default:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="gp">In [21]: </span><span class="n">arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[21]: </span><span class="go">DataType(date32[day])</span>

<span class="gp">In [22]: </span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[22]: </span><span class="go">&lt;pyarrow.Date32Scalar: datetime.date(2018, 12, 31)&gt;</span>
</pre></div>
</div>
<p>To use the 64-bit <code class="docutils literal notranslate"><span class="pre">date64</span></code>, specify this explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;date64&#39;</span><span class="p">)</span>

<span class="gp">In [24]: </span><span class="n">arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[24]: </span><span class="go">DataType(date64[ms])</span>
</pre></div>
</div>
<p>When converting back with <code class="docutils literal notranslate"><span class="pre">to_pandas</span></code>, object arrays of
<code class="docutils literal notranslate"><span class="pre">datetime.date</span></code> objects are returned:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">arr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="gh">Out[25]: </span>
<span class="go">0    2018-12-31</span>
<span class="go">1          None</span>
<span class="go">2    2000-01-01</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>If you want to use NumPy’s <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> dtype instead, pass
<code class="docutils literal notranslate"><span class="pre">date_as_object=False</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">date_as_object</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="gp">In [27]: </span><span class="n">s2</span><span class="o">.</span><span class="n">dtype</span>
<span class="gh">Out[27]: </span><span class="go">dtype(&#39;&lt;M8[ms]&#39;)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As of Arrow <code class="docutils literal notranslate"><span class="pre">0.13</span></code> the parameter <code class="docutils literal notranslate"><span class="pre">date_as_object</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default. Older versions must pass <code class="docutils literal notranslate"><span class="pre">date_as_object=True</span></code> to
obtain this behavior</p>
</div>
</section>
<section id="time-types">
<h3>Time types<a class="headerlink" href="#time-types" title="Permalink to this heading">#</a></h3>
<p>The builtin <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> objects inside Pandas data structures will be
converted to an Arrow <code class="docutils literal notranslate"><span class="pre">time64</span></code> and <a class="reference internal" href="generated/pyarrow.Time64Array.html#pyarrow.Time64Array" title="pyarrow.Time64Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Time64Array</span></code></a> respectively.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">time</span>

<span class="gp">In [29]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">time</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">time</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>

<span class="gp">In [30]: </span><span class="n">s</span>
<span class="gh">Out[30]: </span>
<span class="go">0    01:01:01</span>
<span class="go">1    02:02:02</span>
<span class="go">dtype: object</span>

<span class="gp">In [31]: </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="gp">In [32]: </span><span class="n">arr</span><span class="o">.</span><span class="n">type</span>
<span class="gh">Out[32]: </span><span class="go">Time64Type(time64[us])</span>

<span class="gp">In [33]: </span><span class="n">arr</span>
<span class="gh">Out[33]: </span>
<span class="go">&lt;pyarrow.lib.Time64Array object at 0x7fbd77bb9de0&gt;</span>
<span class="go">[</span>
<span class="go">  01:01:01.000000,</span>
<span class="go">  02:02:02.000000</span>
<span class="go">]</span>
</pre></div>
</div>
<p>When converting to pandas, arrays of <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code> objects are returned:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">arr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="gh">Out[34]: </span>
<span class="go">0    01:01:01</span>
<span class="go">1    02:02:02</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</section>
</section>
<section id="nullable-types">
<h2>Nullable types<a class="headerlink" href="#nullable-types" title="Permalink to this heading">#</a></h2>
<p>In Arrow all data types are nullable, meaning they support storing missing
values. In pandas, however, not all data types have support for missing data.
Most notably, the default integer data types do not, and will get casted
to float when missing values are introduced. Therefore, when an Arrow array
or table gets converted to pandas, integer columns will become float when
missing values are present:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">&lt;pyarrow.lib.Int64Array object at 0x7f07d467c640&gt;</span>
<span class="go">[</span>
<span class="go">  1,</span>
<span class="go">  2,</span>
<span class="go">  null</span>
<span class="go">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="go">0    1.0</span>
<span class="go">1    2.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>Pandas has experimental nullable data types
(<a class="reference external" href="https://pandas.pydata.org/docs/user_guide/integer_na.html">https://pandas.pydata.org/docs/user_guide/integer_na.html</a>). Arrows supports
round trip conversion for those:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Int64&quot;</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">      a</span>
<span class="go">0     1</span>
<span class="go">1     2</span>
<span class="go">2  &lt;NA&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span>
<span class="go">Out[32]:</span>
<span class="go">pyarrow.Table</span>
<span class="go">a: int64</span>
<span class="go">----</span>
<span class="go">a: [[1,2,null]]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="go">      a</span>
<span class="go">0     1</span>
<span class="go">1     2</span>
<span class="go">2  &lt;NA&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">dtypes</span>
<span class="go">a    Int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>This roundtrip conversion works because metadata about the original pandas
DataFrame gets stored in the Arrow table. However, if you have Arrow data (or
e.g. a Parquet file) not originating from a pandas DataFrame with nullable
data types, the default conversion to pandas will not use those nullable
dtypes.</p>
<p>The <a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.to_pandas" title="pyarrow.Table.to_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pyarrow.Table.to_pandas()</span></code></a> method has a <code class="docutils literal notranslate"><span class="pre">types_mapper</span></code> keyword
that can be used to override the default data type used for the resulting
pandas DataFrame. This way, you can instruct Arrow to create a pandas
DataFrame using nullable dtypes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="go">     a</span>
<span class="go">0  1.0</span>
<span class="go">1  2.0</span>
<span class="go">2  NaN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">types_mapper</span><span class="o">=</span><span class="p">{</span><span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">()}</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
<span class="go">      a</span>
<span class="go">0     1</span>
<span class="go">1     2</span>
<span class="go">2  &lt;NA&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">types_mapper</span></code> keyword expects a function that will return the pandas
data type to use given a pyarrow data type. By using the <code class="docutils literal notranslate"><span class="pre">dict.get</span></code> method,
we can create such a function using a dictionary.</p>
<p>If you want to use all currently supported nullable dtypes by pandas, this
dictionary becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dtype_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">int8</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int8Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">int16</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int16Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">int32</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int32Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">uint8</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">UInt8Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">uint16</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">UInt16Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">uint32</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">UInt32Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">uint64</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">UInt64Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">bool_</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">BooleanDtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">float32</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Float32Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">float64</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">Float64Dtype</span><span class="p">(),</span>
    <span class="n">pa</span><span class="o">.</span><span class="n">string</span><span class="p">():</span> <span class="n">pd</span><span class="o">.</span><span class="n">StringDtype</span><span class="p">(),</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">types_mapper</span><span class="o">=</span><span class="n">dtype_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
</pre></div>
</div>
<p>When using the pandas API for reading Parquet files (<code class="docutils literal notranslate"><span class="pre">pd.read_parquet(..)</span></code>),
this can also be achieved by passing <code class="docutils literal notranslate"><span class="pre">use_nullable_dtypes</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">use_nullable_dtypes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="memory-usage-and-zero-copy">
<h2>Memory Usage and Zero Copy<a class="headerlink" href="#memory-usage-and-zero-copy" title="Permalink to this heading">#</a></h2>
<p>When converting from Arrow data structures to pandas objects using various
<code class="docutils literal notranslate"><span class="pre">to_pandas</span></code> methods, one must occasionally be mindful of issues related to
performance and memory usage.</p>
<p>Since pandas’s internal data representation is generally different from the
Arrow columnar format, zero copy conversions (where no memory allocation or
computation is required) are only possible in certain limited cases.</p>
<p>In the worst case scenario, calling <code class="docutils literal notranslate"><span class="pre">to_pandas</span></code> will result in two versions
of the data in memory, one for Arrow and one for pandas, yielding approximately
twice the memory footprint. We have implement some mitigations for this case,
particularly when creating large <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, that we describe below.</p>
<section id="zero-copy-series-conversions">
<h3>Zero Copy Series Conversions<a class="headerlink" href="#zero-copy-series-conversions" title="Permalink to this heading">#</a></h3>
<p>Zero copy conversions from <code class="docutils literal notranslate"><span class="pre">Array</span></code> or <code class="docutils literal notranslate"><span class="pre">ChunkedArray</span></code> to NumPy arrays or
pandas Series are possible in certain narrow cases:</p>
<ul class="simple">
<li><p>The Arrow data is stored in an integer (signed or unsigned <code class="docutils literal notranslate"><span class="pre">int8</span></code> through
<code class="docutils literal notranslate"><span class="pre">int64</span></code>) or floating point type (<code class="docutils literal notranslate"><span class="pre">float16</span></code> through <code class="docutils literal notranslate"><span class="pre">float64</span></code>). This
includes many numeric types as well as timestamps.</p></li>
<li><p>The Arrow data has no null values (since these are represented using bitmaps
which are not supported by pandas).</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">ChunkedArray</span></code>, the data consists of a single chunk,
i.e. <code class="docutils literal notranslate"><span class="pre">arr.num_chunks</span> <span class="pre">==</span> <span class="pre">1</span></code>. Multiple chunks will always require a copy
because of pandas’s contiguousness requirement.</p></li>
</ul>
<p>In these scenarios, <code class="docutils literal notranslate"><span class="pre">to_pandas</span></code> or <code class="docutils literal notranslate"><span class="pre">to_numpy</span></code> will be zero copy. In all
other scenarios, a copy will be required.</p>
</section>
<section id="reducing-memory-use-in-table-to-pandas">
<h3>Reducing Memory Use in <code class="docutils literal notranslate"><span class="pre">Table.to_pandas</span></code><a class="headerlink" href="#reducing-memory-use-in-table-to-pandas" title="Permalink to this heading">#</a></h3>
<p>As of this writing, pandas applies a data management strategy called
“consolidation” to collect like-typed DataFrame columns in two-dimensional
NumPy arrays, referred to internally as “blocks”. We have gone to great effort
to construct the precise “consolidated” blocks so that pandas will not perform
any further allocation or copies after we hand off the data to
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. The obvious downside of this consolidation strategy is
that it forces a “memory doubling”.</p>
<p>To try to limit the potential effects of “memory doubling” during
<code class="docutils literal notranslate"><span class="pre">Table.to_pandas</span></code>, we provide a couple of options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">split_blocks=True</span></code>, when enabled <code class="docutils literal notranslate"><span class="pre">Table.to_pandas</span></code> produces one internal
DataFrame “block” for each column, skipping the “consolidation” step. Note
that many pandas operations will trigger consolidation anyway, but the peak
memory use may be less than the worst case scenario of a full memory
doubling. As a result of this option, we are able to do zero copy conversions
of columns in the same cases where we can do zero copy with <code class="docutils literal notranslate"><span class="pre">Array</span></code> and
<code class="docutils literal notranslate"><span class="pre">ChunkedArray</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self_destruct=True</span></code>, this destroys the internal Arrow memory buffers in
each column <code class="docutils literal notranslate"><span class="pre">Table</span></code> object as they are converted to the pandas-compatible
representation, potentially releasing memory to the operating system as soon
as a column is converted. Note that this renders the calling <code class="docutils literal notranslate"><span class="pre">Table</span></code> object
unsafe for further use, and any further methods called will cause your Python
process to crash.</p></li>
</ul>
<p>Used together, the call</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">split_blocks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">self_destruct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">table</span>  <span class="c1"># not necessary, but a good practice</span>
</pre></div>
</div>
<p>will yield significantly lower memory usage in some scenarios. Without these
options, <code class="docutils literal notranslate"><span class="pre">to_pandas</span></code> will always double memory.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">self_destruct=True</span></code> is not guaranteed to save memory. Since the
conversion happens column by column, memory is also freed column by column. But
if multiple columns share an underlying buffer, then no memory will be freed
until all of those columns are converted. In particular, due to implementation
details, data that comes from IPC or Flight is prone to this, as memory will be
laid out as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Record</span> <span class="n">Batch</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Allocation</span> <span class="mi">0</span><span class="p">:</span> <span class="n">array</span> <span class="mi">0</span> <span class="n">chunk</span> <span class="mi">0</span><span class="p">,</span> <span class="n">array</span> <span class="mi">1</span> <span class="n">chunk</span> <span class="mi">0</span><span class="p">,</span> <span class="o">...</span>
<span class="n">Record</span> <span class="n">Batch</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Allocation</span> <span class="mi">1</span><span class="p">:</span> <span class="n">array</span> <span class="mi">0</span> <span class="n">chunk</span> <span class="mi">1</span><span class="p">,</span> <span class="n">array</span> <span class="mi">1</span> <span class="n">chunk</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In this case, no memory can be freed until the entire table is converted, even
with <code class="docutils literal notranslate"><span class="pre">self_destruct=True</span></code>.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframes">DataFrames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-pandas-indexes">Handling pandas Indexes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#type-differences">Type differences</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-arrow-conversion">pandas -&gt; Arrow Conversion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arrow-pandas-conversion">Arrow -&gt; pandas Conversion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-types">Categorical types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datetime-timestamp-types">Datetime (Timestamp) types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#date-types">Date types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-types">Time types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nullable-types">Nullable types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-usage-and-zero-copy">Memory Usage and Zero Copy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-copy-series-conversions">Zero Copy Series Conversions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reducing-memory-use-in-table-to-pandas">Reducing Memory Use in <code class="docutils literal notranslate"><span class="pre">Table.to_pandas</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/apache/arrow/edit/main/docs/source/python/pandas.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2016-2025 Apache Software Foundation.
Apache Arrow, Arrow, Apache, the Apache feather logo, and the Apache Arrow project logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>