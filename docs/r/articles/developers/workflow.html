<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • Arrow R Package</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><script src="../../extra.js"></script><meta property="og:title" content="">
<meta property="og:description" content="arrow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">Arrow R Package</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://arrow.apache.org/" class="external-link">❯❯❯</a>
</li>
<li>
  <a href="../../articles/arrow.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/install.html">Installing the Arrow Package on Linux</a>
    </li>
    <li>
      <a href="../../articles/dataset.html">Working with Arrow Datasets and dplyr</a>
    </li>
    <li>
      <a href="../../articles/fs.html">Working with Cloud Storage (S3)</a>
    </li>
    <li>
      <a href="../../articles/python.html">Apache Arrow in Python and R with reticulate</a>
    </li>
    <li>
      <a href="../../articles/flight.html">Connecting to Flight RPC Servers</a>
    </li>
    <li>
      <a href="../../articles/developing.html">Arrow R Developer Guide</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Developers</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/developers/setup.html">Developer Environment Setup</a>
        </li>
        <li>
          <a href="../../articles/developers/workflow.html">Common Workflow Tasks</a>
        </li>
        <li>
          <a href="../../articles/developers/debugging.html">Debugging</a>
        </li>
        <li>
          <a href="../../articles/developers/install_details.html">Package Installation Details</a>
        </li>
        <li>
          <a href="../../articles/developers/docker.html">Docker</a>
        </li>
        <li>
          <a href="../../articles/developers/bindings.html">Writing Bindings</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Project docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://arrow.apache.org/docs/format/Columnar.html" class="external-link">Specification</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/c_glib" class="external-link">C GLib</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/cpp" class="external-link">C++</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/java" class="external-link">Java</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/js" class="external-link">JavaScript</a>
    </li>
    <li>
      <a href="https://arrow.apache.org/docs/python" class="external-link">Python</a>
    </li>
    <li>
      <a href="../../index.html">R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/apache/arrow/blob/master/r/vignettes/developers/workflow.Rmd" class="external-link"><code>vignettes/developers/workflow.Rmd</code></a></small>
      <div class="hidden name"><code>workflow.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="common-developer-workflow-tasks">Common developer workflow tasks<a class="anchor" aria-label="anchor" href="#common-developer-workflow-tasks"></a>
</h2>
<p>The <code>arrow/r</code> directory contains a <code>Makefile</code> to help with some common tasks from the command line (e.g. <code>make test</code>, <code>make doc</code>, <code>make clean</code>, etc.).</p>
<div class="section level3">
<h3 id="loading-arrow">Loading arrow<a class="anchor" aria-label="anchor" href="#loading-arrow"></a>
</h3>
<p>You can load the R package via <code>devtools::load_all()</code>.</p>
</div>
<div class="section level3">
<h3 id="rebuilding-the-documentation">Rebuilding the documentation<a class="anchor" aria-label="anchor" href="#rebuilding-the-documentation"></a>
</h3>
<p>The R documentation uses the <a href="https://roxygen2.r-lib.org/articles/rd.html#functions" class="external-link"><code>@examplesIf</code></a> tag introduced in <code>roxygen2</code> version 7.1.2.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"r-lib/roxygen2"</span><span class="op">)</span></code></pre></div>
<p>You can use <code>devtools::document()</code> and <code><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">pkgdown::build_site()</a></code> to rebuild the documentation and preview the results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Update roxygen documentation</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span>

<span class="co"># To preview the documentation website</span>
<span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span>preview<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="styling-and-linting">Styling and linting<a class="anchor" aria-label="anchor" href="#styling-and-linting"></a>
</h3>
<div class="section level4">
<h4 id="r-code">R code<a class="anchor" aria-label="anchor" href="#r-code"></a>
</h4>
<p>The R code in the package follows <a href="https://style.tidyverse.org/" class="external-link">the tidyverse style</a>. On PR submission (and on pushes) our CI will run linting and will flag possible errors on the pull request with annotations.</p>
<p>To run the <a href="https://github.com/jimhester/lintr" class="external-link">lintr</a> locally, install the lintr package (note, we currently use a fork that includes fixes not yet accepted upstream, see how lintr is being installed in the file <code>ci/docker/linux-apt-lint.dockerfile</code> for the current status) and then run</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">lintr</span><span class="fu">::</span><span class="fu">lint_package</span><span class="op">(</span><span class="st">"arrow/r"</span><span class="op">)</span></code></pre></div>
<p>You can automatically change the formatting of the code in the package using the <a href="https://styler.r-lib.org/" class="external-link">styler</a> package. There are two ways to do this:</p>
<ol style="list-style-type: decimal">
<li><p>Use the comment bot to do this automatically with the command <code>@github-actions autotune</code> on a PR, and commit it back to the branch.</p></li>
<li><p>Run the styler locally either via Makefile commands:</p></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="fu">make</span> style <span class="co"># (for only the files changed)</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="fu">make</span> style-all <span class="co"># (for all files)</span></a></code></pre></div>
<p>or in R:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># note the two excluded files which should not be styled</span>
<span class="fu">styler</span><span class="fu">::</span><span class="fu">style_pkg</span><span class="op">(</span>exclude_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tests/testthat/latin1.R"</span>, <span class="st">"data-raw/codegen.R"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The styler package will fix many styling errors, thought not all lintr errors are automatically fixable with styler. The list of files we intentionally do not style is in <code>r/.styler_excludes.R</code>.</p>
</div>
<div class="section level4">
<h4 id="c-code">C++ code<a class="anchor" aria-label="anchor" href="#c-code"></a>
</h4>
<p>The arrow package uses some customized tools on top of <a href="https://cpp11.r-lib.org/" class="external-link">cpp11</a> to prepare its C++ code in <code>src/</code>. This is because there are some features that are only enabled and built conditionally during build time. If you change C++ code in the R package, you will need to set the <code>ARROW_R_DEV</code> environment variable to <code>true</code> (optionally, add it to your <code>~/.Renviron</code> file to persist across sessions) so that the <code>data-raw/codegen.R</code> file is used for code generation. The <code>Makefile</code> commands also handles this automatically.</p>
<p>We use Google C++ style in our C++ code. The easiest way to accomplish this is use an editors/IDE that formats your code for you. Many popular editors/IDEs have support for running <code>clang-format</code> on C++ files when you save them. Installing/enabling the appropriate plugin may save you much frustration.</p>
<p>Check for style errors with</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="ex">./lint.sh</span></a></code></pre></div>
<p>Fix any style issues before committing with</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="ex">./lint.sh</span> --fix</a></code></pre></div>
<p>The lint script requires Python 3 and <code>clang-format</code>. If the command isn’t found, you can explicitly provide the path to it like:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="va">CLANG_FORMAT=</span>/opt/llvm/bin/clang-format <span class="ex">./lint.sh</span></a></code></pre></div>
<p>You can see what version of <code>clang-format</code> is required by the following command:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">(</span><span class="bu">.</span> <span class="ex">../.env</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> <span class="va">${CLANG_TOOLS}</span><span class="kw">)</span></a></code></pre></div>
<p><em>Note</em> that the lint script requires Python 3 and the Python dependencies (note that `cmake_format is pinned to a specific version):</p>
<ul>
<li>autopep8</li>
<li>flake8</li>
<li>cmake_format==0.5.2</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="running-tests">Running tests<a class="anchor" aria-label="anchor" href="#running-tests"></a>
</h3>
<p>Tests can be run either using <code>devtools::test()</code> or the Makefile alternative.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Run the test suite, optionally filtering file names</span></a>
<a class="sourceLine" id="cb10-2" title="2">devtools<span class="op">::</span><span class="kw">test</span>(<span class="dt">filter=</span><span class="st">"^regexp$"</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co"># or the Makefile alternative from the arrow/r directory in a shell:</span></a>
<a class="sourceLine" id="cb10-5" title="5">make test file=regexp</a></code></pre></div>
<p>Some tests are conditionally enabled based on the availability of certain features in the package build (S3 support, compression libraries, etc.). Others are generally skipped by default but can be enabled with environment variables or other settings:</p>
<ul>
<li><p>All tests are skipped on Linux if the package builds without the C++ libarrow. To make the build fail if libarrow is not available (as in, to test that the C++ build was successful), set <code>TEST_R_WITH_ARROW=true</code></p></li>
<li><p>Some tests are disabled unless <code>ARROW_R_DEV=true</code></p></li>
<li><p>Tests that require allocating &gt;2GB of memory to test Large types are disabled unless <code>ARROW_LARGE_MEMORY_TESTS=true</code></p></li>
<li><p>Integration tests against a real S3 bucket are disabled unless credentials are set in <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>; these are available on request</p></li>
<li><p>S3 tests using <a href="https://min.io/" class="external-link">MinIO</a> locally are enabled if the <code>minio server</code> process is found running. If you’re running MinIO with custom settings, you can set <code>MINIO_ACCESS_KEY</code>, <code>MINIO_SECRET_KEY</code>, and <code>MINIO_PORT</code> to override the defaults.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="running-checks">Running checks<a class="anchor" aria-label="anchor" href="#running-checks"></a>
</h3>
<p>You can run package checks by using <code>devtools::check()</code> and check test coverage with <code>covr::package_coverage()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># All package checks</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span>

<span class="co"># See test coverage statistics</span>
<span class="fu">covr</span><span class="fu">::</span><span class="fu">report</span><span class="op">(</span><span class="op">)</span>
<span class="fu">covr</span><span class="fu">::</span><span class="fu">package_coverage</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>For full package validation, you can run the following commands from a terminal.</p>
<pre><code>R CMD build .
R CMD check arrow_*.tar.gz --as-cran</code></pre>
</div>
<div class="section level3">
<h3 id="running-additional-ci-checks">Running additional CI checks<a class="anchor" aria-label="anchor" href="#running-additional-ci-checks"></a>
</h3>
<p>On a pull request, there are some actions you can trigger by commenting on the PR. We have additional CI checks that run nightly and can be requested on demand using an internal tool called <a href="https://arrow.apache.org/docs/developers/crossbow.html" class="external-link">crossbow</a>. A few important GitHub comment commands are shown below.</p>
<div class="section level5">
<h5 id="run-all-extended-r-ci-tasks">Run all extended R CI tasks<a class="anchor" aria-label="anchor" href="#run-all-extended-r-ci-tasks"></a>
</h5>
<pre><code>@github-actions crossbow submit -g r</code></pre>
<p>This runs each of the R-related CI tasks.</p>
</div>
<div class="section level5">
<h5 id="run-a-specific-task">Run a specific task<a class="anchor" aria-label="anchor" href="#run-a-specific-task"></a>
</h5>
<pre><code>@github-actions crossbow submit {task-name}</code></pre>
<p>See the <code>r:</code> group definition near the beginning of the <a href="https://github.com/apache/arrow/blob/master/dev/tasks/tasks.yml" class="external-link">crossbow configuration</a> for a list of glob expression patterns that match names of items in the <code>tasks:</code> list below it.</p>
</div>
<div class="section level5">
<h5 id="run-linting-and-documentation-building-tasks">Run linting and documentation building tasks<a class="anchor" aria-label="anchor" href="#run-linting-and-documentation-building-tasks"></a>
</h5>
<pre><code>@github-actions autotune</code></pre>
<p>This will run and fix lint C++ linting errors, run R documentation (among other cleanup tasks), run styler on any changed R code, and commit the resulting updates to the branch.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Neal Richardson, Ian Cook, Nic Crane, Jonathan Keane, Romain François, Jeroen Ooms, Apache Arrow.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
