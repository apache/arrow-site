<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above meta tags *must* come first in the head; any other head content must come *after* these tags -->
    
    <title>Apache Arrow nanoarrow 0.4.0 Release | Apache Arrow</title>
    

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Apache Arrow nanoarrow 0.4.0 Release" />
<meta name="author" content="pmc" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Apache Arrow team is pleased to announce the 0.4.0 release of Apache Arrow nanoarrow. This release covers 46 resolved issues from 5 contributors. Release Highlights The primary focus of the nanoarrow 0.4.0 release was testing, stability, and code quality. Notably, an implementation of the C data interface integration test protocol was added to ensure data produced or consumed by nanoarrow can be consumed or produced by other Arrow implementations. Apache Arrow nanoarrow 0.4.0 also contains experimental Python bindings to the C library for the purposes of community testing and feedback while a more stable set of bindings is prepared (targeted for 0.5.0). See the Changelog for a detailed list of contributions to this release. Breaking Changes Changes included in the nanoarrow 0.4.0 release will not break most downstream code; however, several changes in the C library may result in additional compiler warnings that could cause downstream build failures for projects with strict compiler warning policies. First, in debug mode (i.e., when NANOARROW_DEBUG is defined), an ignored return value for functions that return ArrowErrorCode now issues a compiler warning for compilers that support an &quot;unused result&quot; attribute. Ignoring the return value of these functions is a common error and return values that are not equal to NANOARROW_OK should be propagated as soon as possible. The C library provides tools to check return values in a readable way. Notably: NANOARROW_RETURN_NOT_OK() can be used in a wrapper function that also returns ArrowErrorCode. NANOARROW_THROW_NOT_OK() can be used from C++ code that inclues nanoarrow.hpp and is prepared to handle exceptions. NANOARROW_ASSERT_OK() can be used to to check for NANOARROW_OK only in debug mode (i.e., silently ignore errors in release mode and will crash in debug mode with a message indicating the location of the error). Of these, the first or second is preferred. The Getting Started with nanoarrow in C/C++ tutorial includes examples and advice for handling errors emanating from the nanoarrow C library. Second, in debug mode (i.e., when NANOARROW_DEBUG is defined), the appropriate attribute was added to check the format string passed to ArrowErrorSet() against the provided arguments. Correct code will be unaffected by this change; however, actual arguments that do not match the format string (e.g., an int64_t that is passed to ArrowErrorSet() with a format string of &quot;%d&quot;) should be cast to the appropriate C type (e.g., int) or the format string should be fixed to support the type of the actual argument (e.g., using &quot;%&quot; PRId64). Third, functions in the C library that do not take ownersip of or modify input are now properly marked as const. For example, ArrowArrayViewGetIntUnsafe() previously accepted a struct ArrowArrayView* and now accepts a const struct ArrowArrayView*. This change makes it more difficult to accidentally modify input intended to be read-only and improves usability from C++. Downstream projects that get a new warning about discarding a const qualifier may need to adjust variable declarations or formal parameter types; however, most projects should be unaffected by this change. C/C++ The nanoarrow 0.4.0 release includes a number of bugfixes and improvements to the core C library and C++ helpers. An implementation of the C data interface integration test was added, including a reader/writer for the Arrow integration testing JSON format. This was used to improve test coverage of the IPC reader and to add nanoarrow as a participating member of integration testing in the CI job that runs in the main Arrow repository. The C library now supports a wider range of extended compiler warnings to make it easier to vendor in projects with strict compiler warning policies. C++ helpers were improved to support const-correctness. As a result, the UniqueSchema, UniqueArray, UniqueArrayView, and UniqueBuffer now work with a wider variety of C++ wrappers (e.g., std::unordered_map). R bindings The nanoarrow R bindings are distributed as the nanoarrow package on CRAN. The 0.4.0 release of the R bindings includes improvements in type support and stability. Notably: Documentation was improved for low-level users of nanoarrow that are producing or consuming ArrowArray, ArrowSchema, and/or ArrowArrayStream structures from C or C++ code in other R packages. Improved conversion of list()s to support more types when the arrow R package is not available. Added more implmentations of as_nanoarrow_array_stream() to support more object types from the arrow R package. Added conversion from Arrow integer arrays to character(). Python bindings The nanoarrow 0.4.0 release is the first release that contains Python bindings to the nanoarrow C library! These initial Python bindings are experiemntal and are provided to solicit an initial round of feedback from the Arrow community. Like the nanoarrow C library and R bindings, it provides tools to facilitate the use of the Arrow C Data and Arrow C Stream interfaces. You can install the initial release of the Python bindings from PyPI. The nanoarrow Python package has been submitted to conda-forge and should be available once the recipe has been reviewed. pip install nanoarrow The initial release of the Python bindings contain repr()s to print out human-readable representations of structures in the Arrow C Data and Stream interfaces. import nanoarrow as na import pyarrow as pa na.c_schema(pa.decimal128(10, 3)) &lt;nanoarrow.c_lib.CSchema decimal128(10, 3)&gt; - format: &#39;d:10,3&#39; - name: &#39;&#39; - flags: 2 - metadata: NULL - dictionary: NULL - children[0]: na.c_array(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArray string&gt; - length: 4 - offset: 0 - null_count: 1 - buffers: (2939032895680, 2939032895616, 2939032895744) - dictionary: NULL - children[0]: In addition to Arrow C Data interface wrappers, the initial nanoarrow Python bindings expose wrappers for a few nanoarrow C library types like the ArrowArrayView that can be used to interpret the content of the raw structures. na.c_array_view(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArrayView&gt; - storage_type: &#39;string&#39; - length: 4 - offset: 0 - null_count: 1 - buffers[3]: - &lt;bool validity[1 b] 11100000&gt; - &lt;int32 data_offset[20 b] 0 3 6 11 11&gt; - &lt;string data[11 b] b&#39;onetwothree&#39;&gt; - dictionary: NULL - children[0]: Finally, the initial bindings contain a user-facing &quot;data type&quot; class. The Schema, like its C Data interface counterpart, can represent a pyarrow.Schema, a pyarrow.Field, or a pyarrow.DataType. na.int32() Schema(INT32) na.struct({&quot;col1&quot;: na.int32()}) Schema(STRUCT, fields=[Schema(INT32, name=&#39;col1&#39;)]) The next release of nanoarrow for Python will include a user-facing Array class among other improvements and features based on community feedback! For a more in-depth review of the initial Python bindings, see the Getting started in Python guide and the Python API reference Contributors This release consists of contributions from 4 contributors in addition to the invaluable advice and support of the Apache Arrow developer mailing list. $ git shortlog -sn 798a1b8f096c84e2b6f887427649f1cb496412b2..apache-arrow-nanoarrow-0.4.0 | grep -v &quot;GitHub Actions&quot; 35 Dewey Dunnington 3 William Ayd 2 Dirk Eddelbuettel 2 Joris Van den Bossche 1 eitsupi" />
<meta property="og:description" content="The Apache Arrow team is pleased to announce the 0.4.0 release of Apache Arrow nanoarrow. This release covers 46 resolved issues from 5 contributors. Release Highlights The primary focus of the nanoarrow 0.4.0 release was testing, stability, and code quality. Notably, an implementation of the C data interface integration test protocol was added to ensure data produced or consumed by nanoarrow can be consumed or produced by other Arrow implementations. Apache Arrow nanoarrow 0.4.0 also contains experimental Python bindings to the C library for the purposes of community testing and feedback while a more stable set of bindings is prepared (targeted for 0.5.0). See the Changelog for a detailed list of contributions to this release. Breaking Changes Changes included in the nanoarrow 0.4.0 release will not break most downstream code; however, several changes in the C library may result in additional compiler warnings that could cause downstream build failures for projects with strict compiler warning policies. First, in debug mode (i.e., when NANOARROW_DEBUG is defined), an ignored return value for functions that return ArrowErrorCode now issues a compiler warning for compilers that support an &quot;unused result&quot; attribute. Ignoring the return value of these functions is a common error and return values that are not equal to NANOARROW_OK should be propagated as soon as possible. The C library provides tools to check return values in a readable way. Notably: NANOARROW_RETURN_NOT_OK() can be used in a wrapper function that also returns ArrowErrorCode. NANOARROW_THROW_NOT_OK() can be used from C++ code that inclues nanoarrow.hpp and is prepared to handle exceptions. NANOARROW_ASSERT_OK() can be used to to check for NANOARROW_OK only in debug mode (i.e., silently ignore errors in release mode and will crash in debug mode with a message indicating the location of the error). Of these, the first or second is preferred. The Getting Started with nanoarrow in C/C++ tutorial includes examples and advice for handling errors emanating from the nanoarrow C library. Second, in debug mode (i.e., when NANOARROW_DEBUG is defined), the appropriate attribute was added to check the format string passed to ArrowErrorSet() against the provided arguments. Correct code will be unaffected by this change; however, actual arguments that do not match the format string (e.g., an int64_t that is passed to ArrowErrorSet() with a format string of &quot;%d&quot;) should be cast to the appropriate C type (e.g., int) or the format string should be fixed to support the type of the actual argument (e.g., using &quot;%&quot; PRId64). Third, functions in the C library that do not take ownersip of or modify input are now properly marked as const. For example, ArrowArrayViewGetIntUnsafe() previously accepted a struct ArrowArrayView* and now accepts a const struct ArrowArrayView*. This change makes it more difficult to accidentally modify input intended to be read-only and improves usability from C++. Downstream projects that get a new warning about discarding a const qualifier may need to adjust variable declarations or formal parameter types; however, most projects should be unaffected by this change. C/C++ The nanoarrow 0.4.0 release includes a number of bugfixes and improvements to the core C library and C++ helpers. An implementation of the C data interface integration test was added, including a reader/writer for the Arrow integration testing JSON format. This was used to improve test coverage of the IPC reader and to add nanoarrow as a participating member of integration testing in the CI job that runs in the main Arrow repository. The C library now supports a wider range of extended compiler warnings to make it easier to vendor in projects with strict compiler warning policies. C++ helpers were improved to support const-correctness. As a result, the UniqueSchema, UniqueArray, UniqueArrayView, and UniqueBuffer now work with a wider variety of C++ wrappers (e.g., std::unordered_map). R bindings The nanoarrow R bindings are distributed as the nanoarrow package on CRAN. The 0.4.0 release of the R bindings includes improvements in type support and stability. Notably: Documentation was improved for low-level users of nanoarrow that are producing or consuming ArrowArray, ArrowSchema, and/or ArrowArrayStream structures from C or C++ code in other R packages. Improved conversion of list()s to support more types when the arrow R package is not available. Added more implmentations of as_nanoarrow_array_stream() to support more object types from the arrow R package. Added conversion from Arrow integer arrays to character(). Python bindings The nanoarrow 0.4.0 release is the first release that contains Python bindings to the nanoarrow C library! These initial Python bindings are experiemntal and are provided to solicit an initial round of feedback from the Arrow community. Like the nanoarrow C library and R bindings, it provides tools to facilitate the use of the Arrow C Data and Arrow C Stream interfaces. You can install the initial release of the Python bindings from PyPI. The nanoarrow Python package has been submitted to conda-forge and should be available once the recipe has been reviewed. pip install nanoarrow The initial release of the Python bindings contain repr()s to print out human-readable representations of structures in the Arrow C Data and Stream interfaces. import nanoarrow as na import pyarrow as pa na.c_schema(pa.decimal128(10, 3)) &lt;nanoarrow.c_lib.CSchema decimal128(10, 3)&gt; - format: &#39;d:10,3&#39; - name: &#39;&#39; - flags: 2 - metadata: NULL - dictionary: NULL - children[0]: na.c_array(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArray string&gt; - length: 4 - offset: 0 - null_count: 1 - buffers: (2939032895680, 2939032895616, 2939032895744) - dictionary: NULL - children[0]: In addition to Arrow C Data interface wrappers, the initial nanoarrow Python bindings expose wrappers for a few nanoarrow C library types like the ArrowArrayView that can be used to interpret the content of the raw structures. na.c_array_view(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArrayView&gt; - storage_type: &#39;string&#39; - length: 4 - offset: 0 - null_count: 1 - buffers[3]: - &lt;bool validity[1 b] 11100000&gt; - &lt;int32 data_offset[20 b] 0 3 6 11 11&gt; - &lt;string data[11 b] b&#39;onetwothree&#39;&gt; - dictionary: NULL - children[0]: Finally, the initial bindings contain a user-facing &quot;data type&quot; class. The Schema, like its C Data interface counterpart, can represent a pyarrow.Schema, a pyarrow.Field, or a pyarrow.DataType. na.int32() Schema(INT32) na.struct({&quot;col1&quot;: na.int32()}) Schema(STRUCT, fields=[Schema(INT32, name=&#39;col1&#39;)]) The next release of nanoarrow for Python will include a user-facing Array class among other improvements and features based on community feedback! For a more in-depth review of the initial Python bindings, see the Getting started in Python guide and the Python API reference Contributors This release consists of contributions from 4 contributors in addition to the invaluable advice and support of the Apache Arrow developer mailing list. $ git shortlog -sn 798a1b8f096c84e2b6f887427649f1cb496412b2..apache-arrow-nanoarrow-0.4.0 | grep -v &quot;GitHub Actions&quot; 35 Dewey Dunnington 3 William Ayd 2 Dirk Eddelbuettel 2 Joris Van den Bossche 1 eitsupi" />
<link rel="canonical" href="https://arrow.apache.org/blog/2024/01/29/nanoarrow-0.4.0-release/" />
<meta property="og:url" content="https://arrow.apache.org/blog/2024/01/29/nanoarrow-0.4.0-release/" />
<meta property="og:site_name" content="Apache Arrow" />
<meta property="og:image" content="https://arrow.apache.org/img/arrow-logo_horizontal_black-txt_white-bg.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-01-29T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://arrow.apache.org/img/arrow-logo_horizontal_black-txt_white-bg.png" />
<meta property="twitter:title" content="Apache Arrow nanoarrow 0.4.0 Release" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pmc"},"dateModified":"2024-01-29T00:00:00-05:00","datePublished":"2024-01-29T00:00:00-05:00","description":"The Apache Arrow team is pleased to announce the 0.4.0 release of Apache Arrow nanoarrow. This release covers 46 resolved issues from 5 contributors. Release Highlights The primary focus of the nanoarrow 0.4.0 release was testing, stability, and code quality. Notably, an implementation of the C data interface integration test protocol was added to ensure data produced or consumed by nanoarrow can be consumed or produced by other Arrow implementations. Apache Arrow nanoarrow 0.4.0 also contains experimental Python bindings to the C library for the purposes of community testing and feedback while a more stable set of bindings is prepared (targeted for 0.5.0). See the Changelog for a detailed list of contributions to this release. Breaking Changes Changes included in the nanoarrow 0.4.0 release will not break most downstream code; however, several changes in the C library may result in additional compiler warnings that could cause downstream build failures for projects with strict compiler warning policies. First, in debug mode (i.e., when NANOARROW_DEBUG is defined), an ignored return value for functions that return ArrowErrorCode now issues a compiler warning for compilers that support an &quot;unused result&quot; attribute. Ignoring the return value of these functions is a common error and return values that are not equal to NANOARROW_OK should be propagated as soon as possible. The C library provides tools to check return values in a readable way. Notably: NANOARROW_RETURN_NOT_OK() can be used in a wrapper function that also returns ArrowErrorCode. NANOARROW_THROW_NOT_OK() can be used from C++ code that inclues nanoarrow.hpp and is prepared to handle exceptions. NANOARROW_ASSERT_OK() can be used to to check for NANOARROW_OK only in debug mode (i.e., silently ignore errors in release mode and will crash in debug mode with a message indicating the location of the error). Of these, the first or second is preferred. The Getting Started with nanoarrow in C/C++ tutorial includes examples and advice for handling errors emanating from the nanoarrow C library. Second, in debug mode (i.e., when NANOARROW_DEBUG is defined), the appropriate attribute was added to check the format string passed to ArrowErrorSet() against the provided arguments. Correct code will be unaffected by this change; however, actual arguments that do not match the format string (e.g., an int64_t that is passed to ArrowErrorSet() with a format string of &quot;%d&quot;) should be cast to the appropriate C type (e.g., int) or the format string should be fixed to support the type of the actual argument (e.g., using &quot;%&quot; PRId64). Third, functions in the C library that do not take ownersip of or modify input are now properly marked as const. For example, ArrowArrayViewGetIntUnsafe() previously accepted a struct ArrowArrayView* and now accepts a const struct ArrowArrayView*. This change makes it more difficult to accidentally modify input intended to be read-only and improves usability from C++. Downstream projects that get a new warning about discarding a const qualifier may need to adjust variable declarations or formal parameter types; however, most projects should be unaffected by this change. C/C++ The nanoarrow 0.4.0 release includes a number of bugfixes and improvements to the core C library and C++ helpers. An implementation of the C data interface integration test was added, including a reader/writer for the Arrow integration testing JSON format. This was used to improve test coverage of the IPC reader and to add nanoarrow as a participating member of integration testing in the CI job that runs in the main Arrow repository. The C library now supports a wider range of extended compiler warnings to make it easier to vendor in projects with strict compiler warning policies. C++ helpers were improved to support const-correctness. As a result, the UniqueSchema, UniqueArray, UniqueArrayView, and UniqueBuffer now work with a wider variety of C++ wrappers (e.g., std::unordered_map). R bindings The nanoarrow R bindings are distributed as the nanoarrow package on CRAN. The 0.4.0 release of the R bindings includes improvements in type support and stability. Notably: Documentation was improved for low-level users of nanoarrow that are producing or consuming ArrowArray, ArrowSchema, and/or ArrowArrayStream structures from C or C++ code in other R packages. Improved conversion of list()s to support more types when the arrow R package is not available. Added more implmentations of as_nanoarrow_array_stream() to support more object types from the arrow R package. Added conversion from Arrow integer arrays to character(). Python bindings The nanoarrow 0.4.0 release is the first release that contains Python bindings to the nanoarrow C library! These initial Python bindings are experiemntal and are provided to solicit an initial round of feedback from the Arrow community. Like the nanoarrow C library and R bindings, it provides tools to facilitate the use of the Arrow C Data and Arrow C Stream interfaces. You can install the initial release of the Python bindings from PyPI. The nanoarrow Python package has been submitted to conda-forge and should be available once the recipe has been reviewed. pip install nanoarrow The initial release of the Python bindings contain repr()s to print out human-readable representations of structures in the Arrow C Data and Stream interfaces. import nanoarrow as na import pyarrow as pa na.c_schema(pa.decimal128(10, 3)) &lt;nanoarrow.c_lib.CSchema decimal128(10, 3)&gt; - format: &#39;d:10,3&#39; - name: &#39;&#39; - flags: 2 - metadata: NULL - dictionary: NULL - children[0]: na.c_array(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArray string&gt; - length: 4 - offset: 0 - null_count: 1 - buffers: (2939032895680, 2939032895616, 2939032895744) - dictionary: NULL - children[0]: In addition to Arrow C Data interface wrappers, the initial nanoarrow Python bindings expose wrappers for a few nanoarrow C library types like the ArrowArrayView that can be used to interpret the content of the raw structures. na.c_array_view(pa.array([&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, None])) &lt;nanoarrow.c_lib.CArrayView&gt; - storage_type: &#39;string&#39; - length: 4 - offset: 0 - null_count: 1 - buffers[3]: - &lt;bool validity[1 b] 11100000&gt; - &lt;int32 data_offset[20 b] 0 3 6 11 11&gt; - &lt;string data[11 b] b&#39;onetwothree&#39;&gt; - dictionary: NULL - children[0]: Finally, the initial bindings contain a user-facing &quot;data type&quot; class. The Schema, like its C Data interface counterpart, can represent a pyarrow.Schema, a pyarrow.Field, or a pyarrow.DataType. na.int32() Schema(INT32) na.struct({&quot;col1&quot;: na.int32()}) Schema(STRUCT, fields=[Schema(INT32, name=&#39;col1&#39;)]) The next release of nanoarrow for Python will include a user-facing Array class among other improvements and features based on community feedback! For a more in-depth review of the initial Python bindings, see the Getting started in Python guide and the Python API reference Contributors This release consists of contributions from 4 contributors in addition to the invaluable advice and support of the Apache Arrow developer mailing list. $ git shortlog -sn 798a1b8f096c84e2b6f887427649f1cb496412b2..apache-arrow-nanoarrow-0.4.0 | grep -v &quot;GitHub Actions&quot; 35 Dewey Dunnington 3 William Ayd 2 Dirk Eddelbuettel 2 Joris Van den Bossche 1 eitsupi","headline":"Apache Arrow nanoarrow 0.4.0 Release","image":"https://arrow.apache.org/img/arrow-logo_horizontal_black-txt_white-bg.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://arrow.apache.org/blog/2024/01/29/nanoarrow-0.4.0-release/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://arrow.apache.org/img/logo.png"},"name":"pmc"},"url":"https://arrow.apache.org/blog/2024/01/29/nanoarrow-0.4.0-release/"}</script>
<!-- End Jekyll SEO tag -->


    <!-- favicons -->
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png" id="light1">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png" id="light2">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/img/apple-touch-icon.png" id="light3">
    <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="/img/apple-touch-icon-120x120.png" id="light4">
    <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="/img/apple-touch-icon-76x76.png" id="light5">
    <link rel="apple-touch-icon" type="image/png" sizes="60x60" href="/img/apple-touch-icon-60x60.png" id="light6">
    <!-- dark mode favicons -->
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16-dark.png" id="dark1">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32-dark.png" id="dark2">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/img/apple-touch-icon-dark.png" id="dark3">
    <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="/img/apple-touch-icon-120x120-dark.png" id="dark4">
    <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="/img/apple-touch-icon-76x76-dark.png" id="dark5">
    <link rel="apple-touch-icon" type="image/png" sizes="60x60" href="/img/apple-touch-icon-60x60-dark.png" id="dark6">

    <script>
      // Switch to the dark-mode favicons if prefers-color-scheme: dark
      function onUpdate() {
        light1 = document.querySelector('link#light1');
        light2 = document.querySelector('link#light2');
        light3 = document.querySelector('link#light3');
        light4 = document.querySelector('link#light4');
        light5 = document.querySelector('link#light5');
        light6 = document.querySelector('link#light6');

        dark1 = document.querySelector('link#dark1');
        dark2 = document.querySelector('link#dark2');
        dark3 = document.querySelector('link#dark3');
        dark4 = document.querySelector('link#dark4');
        dark5 = document.querySelector('link#dark5');
        dark6 = document.querySelector('link#dark6');

        if (matcher.matches) {
          light1.remove();
          light2.remove();
          light3.remove();
          light4.remove();
          light5.remove();
          light6.remove();
          document.head.append(dark1);
          document.head.append(dark2);
          document.head.append(dark3);
          document.head.append(dark4);
          document.head.append(dark5);
          document.head.append(dark6);
        } else {
          dark1.remove();
          dark2.remove();
          dark3.remove();
          dark4.remove();
          dark5.remove();
          dark6.remove();
          document.head.append(light1);
          document.head.append(light2);
          document.head.append(light3);
          document.head.append(light4);
          document.head.append(light5);
          document.head.append(light6);
        }
      }
      matcher = window.matchMedia('(prefers-color-scheme: dark)');
      matcher.addListener(onUpdate);
      onUpdate();
    </script>

    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/syntax.css" rel="stylesheet">
    <script src="/javascript/main.js"></script>
    
    <!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  /* We explicitly disable cookie tracking to avoid privacy issues */
  _paq.push(['disableCookies']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://analytics.apache.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '20']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

    
    <link type="application/atom+xml" rel="alternate" href="https://arrow.apache.org/feed.xml" title="Apache Arrow" />
  </head>


<body class="wrap">
  <header>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
  
  <a class="navbar-brand no-padding" href="/"><img src="/img/arrow-inverse-300px.png" height="40px"></a>
  
   <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#arrow-navbar" aria-controls="arrow-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse justify-content-end" id="arrow-navbar">
      <ul class="nav navbar-nav">
        <li class="nav-item"><a class="nav-link" href="/overview/" role="button" aria-haspopup="true" aria-expanded="false">Overview</a></li>
        <li class="nav-item"><a class="nav-link" href="/faq/" role="button" aria-haspopup="true" aria-expanded="false">FAQ</a></li>
        <li class="nav-item"><a class="nav-link" href="/blog" role="button" aria-haspopup="true" aria-expanded="false">Blog</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownGetArrow" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             Get Arrow
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownGetArrow">
            <a class="dropdown-item" href="/install/">Install</a>
            <a class="dropdown-item" href="/release/">Releases</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownDocumentation" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             Docs
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownDocumentation">
            <a class="dropdown-item" href="/docs">Project Docs</a>
            <a class="dropdown-item" href="/docs/format/Columnar.html">Format</a>
            <hr>
            <a class="dropdown-item" href="/docs/c_glib">C GLib</a>
            <a class="dropdown-item" href="/docs/cpp">C++</a>
            <a class="dropdown-item" href="https://arrow.apache.org/dotnet/">.NET</a>
            <a class="dropdown-item" href="https://godoc.org/github.com/apache/arrow/go/arrow" target="_blank" rel="noopener">Go</a>
            <a class="dropdown-item" href="/docs/java">Java</a>
            <a class="dropdown-item" href="/js/">JavaScript</a>
            <a class="dropdown-item" href="/julia/">Julia</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/blob/main/matlab/README.md" target="_blank" rel="noopener">MATLAB</a>
            <a class="dropdown-item" href="/docs/python">Python</a>
            <a class="dropdown-item" href="/docs/r">R</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/blob/main/ruby/README.md" target="_blank" rel="noopener">Ruby</a>
            <a class="dropdown-item" href="https://docs.rs/arrow/latest" target="_blank" rel="noopener">Rust</a>
            <a class="dropdown-item" href="/swift">Swift</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownSource" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             Source
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownSource">
            <a class="dropdown-item" href="https://github.com/apache/arrow" target="_blank" rel="noopener">Main Repo</a>
            <hr>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/c_glib" target="_blank" rel="noopener">C GLib</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/cpp" target="_blank" rel="noopener">C++</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-dotnet" target="_blank" rel="noopener">.NET</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-go" target="_blank" rel="noopener">Go</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-java" target="_blank" rel="noopener">Java</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-js" target="_blank" rel="noopener">JavaScript</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-julia" target="_blank" rel="noopener">Julia</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/matlab" target="_blank" rel="noopener">MATLAB</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/python" target="_blank" rel="noopener">Python</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/r" target="_blank" rel="noopener">R</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/tree/main/ruby" target="_blank" rel="noopener">Ruby</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-rs" target="_blank" rel="noopener">Rust</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow-swift" target="_blank" rel="noopener">Swift</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownSubprojects" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             Subprojects
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownSubprojects">
            <a class="dropdown-item" href="/adbc">ADBC</a>
            <a class="dropdown-item" href="/docs/format/Flight.html">Arrow Flight</a>
            <a class="dropdown-item" href="/docs/format/FlightSql.html">Arrow Flight SQL</a>
            <a class="dropdown-item" href="https://datafusion.apache.org" target="_blank" rel="noopener">DataFusion</a>
            <a class="dropdown-item" href="/nanoarrow">nanoarrow</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownCommunity" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             Community
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownCommunity">
            <a class="dropdown-item" href="/community/">Communication</a>
            <a class="dropdown-item" href="/docs/developers/index.html">Contributing</a>
            <a class="dropdown-item" href="https://github.com/apache/arrow/issues" target="_blank" rel="noopener">Issue Tracker</a>
            <a class="dropdown-item" href="/committers/">Governance</a>
            <a class="dropdown-item" href="/use_cases/">Use Cases</a>
            <a class="dropdown-item" href="/powered_by/">Powered By</a>
            <a class="dropdown-item" href="/visual_identity/">Visual Identity</a>
            <a class="dropdown-item" href="/security/">Security</a>
            <a class="dropdown-item" href="https://www.apache.org/foundation/policies/conduct.html" target="_blank" rel="noopener">Code of Conduct</a>
          </div>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownASF" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
             ASF Links
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownASF">
            <a class="dropdown-item" href="https://www.apache.org/" target="_blank" rel="noopener">ASF Website</a>
            <a class="dropdown-item" href="https://www.apache.org/licenses/" target="_blank" rel="noopener">License</a>
            <a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener">Donate</a>
            <a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener">Thanks</a>
            <a class="dropdown-item" href="https://www.apache.org/security/" target="_blank" rel="noopener">Security</a>
          </div>
        </li>
      </ul>
    </div>
<!-- /.navbar-collapse -->
  </nav>

  </header>

  <div class="container p-4 pt-5">
    <div class="col-md-8 mx-auto">
      <main role="main" class="pb-5">
        
<h1>
  Apache Arrow nanoarrow 0.4.0 Release
</h1>
<hr class="mt-4 mb-3">



<p class="mb-4 pb-1">
  <span class="badge badge-secondary">Published</span>
  <span class="published mr-3">
    29 Jan 2024
  </span>
  <br>
  <span class="badge badge-secondary">By</span>
  
    <a class="mr-3" href="https://arrow.apache.org">The Apache Arrow PMC (pmc) </a>
  

  
</p>


        <!--

-->
<p>The Apache Arrow team is pleased to announce the 0.4.0 release of
Apache Arrow nanoarrow. This release covers 46 resolved issues from
5 contributors.</p>
<h2>Release Highlights</h2>
<p>The primary focus of the nanoarrow 0.4.0 release was testing, stability, and code
quality. Notably, an implementation of the
<a href="https://arrow.apache.org/docs/format/Integration.html#example-c-data-interface">C data interface integration test</a>
protocol was added to ensure data produced or consumed by nanoarrow can be
consumed or produced by other Arrow implementations.</p>
<p>Apache Arrow nanoarrow 0.4.0 also contains experimental <a href="#python-bindings">Python bindings</a>
to the C library for the purposes of community testing and feedback while a more stable
set of bindings is prepared (targeted for 0.5.0).</p>
<p>See the
<a href="https://github.com/apache/arrow-nanoarrow/blob/apache-arrow-nanoarrow-0.4.0/CHANGELOG.md" target="_blank" rel="noopener">Changelog</a>
for a detailed list of contributions to this release.</p>
<h2>Breaking Changes</h2>
<p>Changes included in the nanoarrow 0.4.0 release will not break most downstream
code; however, several changes in the C library may result in additional compiler
warnings that could cause downstream build failures for projects with strict
compiler warning policies.</p>
<p>First, in debug mode (i.e., when <code>NANOARROW_DEBUG</code> is defined), an ignored return
value for functions that return <code>ArrowErrorCode</code> now issues a compiler warning
for compilers that support an "unused result" attribute. Ignoring the return value
of these functions is a common error and return values that are not
equal to <code>NANOARROW_OK</code> should be propagated as soon as possible. The C library
provides tools to check return values in a readable way. Notably:</p>
<ul>
<li>
<code>NANOARROW_RETURN_NOT_OK()</code> can be used in a wrapper function that also returns
<code>ArrowErrorCode</code>.</li>
<li>
<code>NANOARROW_THROW_NOT_OK()</code> can be used from C++ code that inclues <code>nanoarrow.hpp</code>
and is prepared to handle exceptions.</li>
<li>
<code>NANOARROW_ASSERT_OK()</code> can be used to to check for <code>NANOARROW_OK</code> only in
debug mode (i.e., silently ignore errors in release mode and will crash in
debug mode with a message indicating the location of the error).</li>
</ul>
<p>Of these, the first or second is preferred. The
<a href="https://arrow.apache.org/nanoarrow/main/getting-started/cpp.html#arrow-c-data-nanoarrow-interface-basics">Getting Started with nanoarrow in C/C++ tutorial</a>
includes examples and advice for handling errors emanating from the nanoarrow C
library.</p>
<p>Second, in debug mode (i.e., when <code>NANOARROW_DEBUG</code> is defined), the appropriate
attribute was added to check the format string passed to <code>ArrowErrorSet()</code>
against the provided arguments. Correct code will be unaffected by this change;
however, actual arguments that do not match the format string (e.g., an <code>int64_t</code>
that is passed to <code>ArrowErrorSet()</code> with a format string of <code>"%d"</code>) should be
cast to the appropriate C type (e.g., <code>int</code>) or the format string should be fixed
to support the type of the actual argument (e.g., using <code>"%" PRId64</code>).</p>
<p>Third, functions in the C library that do not take ownersip of or modify input
are now properly marked as <code>const</code>. For example, <code>ArrowArrayViewGetIntUnsafe()</code>
previously accepted a <code>struct ArrowArrayView*</code> and now accepts a
<code>const struct ArrowArrayView*</code>. This change makes it more difficult to
accidentally modify input intended to be read-only and improves usability
from C++. Downstream projects that get a new warning about discarding a <code>const</code>
qualifier may need to adjust variable declarations or formal parameter types;
however, most projects should be unaffected by this change.</p>
<h3>C/C++</h3>
<p>The nanoarrow 0.4.0 release includes a number of bugfixes and improvements
to the core C library and C++ helpers.</p>
<ul>
<li>An implementation of the
<a href="https://arrow.apache.org/docs/format/Integration.html#example-c-data-interface">C data interface integration test</a>
was added, including a reader/writer for the Arrow integration testing JSON
format. This was used to improve test coverage of the IPC reader and to
add nanoarrow as a participating member of integration testing in the CI
job that runs in the main Arrow repository.</li>
<li>The C library now supports a wider range of extended compiler warnings to
make it easier to vendor in projects with strict compiler warning policies.</li>
<li>C++ helpers were improved to support const-correctness. As a result,
the <code>UniqueSchema</code>, <code>UniqueArray</code>, <code>UniqueArrayView</code>, and <code>UniqueBuffer</code> now
work with a wider variety of C++ wrappers (e.g., <code>std::unordered_map</code>).</li>
</ul>
<h3>R bindings</h3>
<p>The nanoarrow R bindings are distributed as the <code>nanoarrow</code> package on
<a href="https://cran.r-project.org/" target="_blank" rel="noopener">CRAN</a>. The 0.4.0 release of the R bindings includes
improvements in type support and stability. Notably:</p>
<ul>
<li>Documentation was improved for low-level users of nanoarrow that are producing or
consuming <code>ArrowArray</code>, <code>ArrowSchema</code>, and/or <code>ArrowArrayStream</code> structures
from C or C++ code in other R packages.</li>
<li>Improved conversion of <code>list()</code>s to support more types when the <strong>arrow</strong> R
package is not available.</li>
<li>Added more implmentations of <code>as_nanoarrow_array_stream()</code> to support more object
types from the <strong>arrow</strong> R package.</li>
<li>Added conversion from Arrow integer arrays to <code>character()</code>.</li>
</ul>
<h3>Python bindings</h3>
<p>The nanoarrow 0.4.0 release is the first release that contains Python bindings to the
nanoarrow C library! These initial Python bindings are experiemntal and are provided
to solicit an initial round of feedback from the Arrow community. Like the nanoarrow
C library and R bindings, it provides tools to facilitate the use of the
<a href="https://arrow.apache.org/docs/format/CDataInterface.html">Arrow C Data</a>
and <a href="https://arrow.apache.org/docs/format/CStreamInterface.html">Arrow C Stream</a>
interfaces.</p>
<p>You can install the initial release of the Python bindings from PyPI. The <code>nanoarrow</code>
Python package has been submitted to conda-forge and should be available once the
recipe has been reviewed.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="shell">pip <span class="nb">install </span>nanoarrow
</code></pre></div></div>
<p>The initial release of the Python bindings contain <code>repr()</code>s to print out human-readable
representations of structures in the Arrow C Data and Stream interfaces.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="python"><span class="kn">import</span> <span class="n">nanoarrow</span> <span class="k">as</span> <span class="n">na</span>
<span class="kn">import</span> <span class="n">pyarrow</span> <span class="k">as</span> <span class="n">pa</span>
<span class="n">na</span><span class="p">.</span><span class="nf">c_schema</span><span class="p">(</span><span class="n">pa</span><span class="p">.</span><span class="nf">decimal128</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;nanoarrow.c_lib.CSchema decimal128(10, 3)&gt;
- format: 'd:10,3'
- name: ''
- flags: 2
- metadata: NULL
- dictionary: NULL
- children[0]:
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="python"><span class="n">na</span><span class="p">.</span><span class="nf">c_array</span><span class="p">(</span><span class="n">pa</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">"</span><span class="s">one</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">two</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">three</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">]))</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;nanoarrow.c_lib.CArray string&gt;
- length: 4
- offset: 0
- null_count: 1
- buffers: (2939032895680, 2939032895616, 2939032895744)
- dictionary: NULL
- children[0]:
</code></pre></div></div>
<p>In addition to Arrow C Data interface wrappers, the initial nanoarrow Python bindings expose
wrappers for a few nanoarrow C library types like the <code>ArrowArrayView</code> that can be used to
interpret the content of the raw structures.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="python"><span class="n">na</span><span class="p">.</span><span class="nf">c_array_view</span><span class="p">(</span><span class="n">pa</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="sh">"</span><span class="s">one</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">two</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">three</span><span class="sh">"</span><span class="p">,</span> <span class="bp">None</span><span class="p">]))</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;nanoarrow.c_lib.CArrayView&gt;
- storage_type: 'string'
- length: 4
- offset: 0
- null_count: 1
- buffers[3]:
  - &lt;bool validity[1 b] 11100000&gt;
  - &lt;int32 data_offset[20 b] 0 3 6 11 11&gt;
  - &lt;string data[11 b] b'onetwothree'&gt;
- dictionary: NULL
- children[0]:
</code></pre></div></div>
<p>Finally, the initial bindings contain a user-facing "data type" class. The <code>Schema</code>, like its
C Data interface counterpart, can represent a <code>pyarrow.Schema</code>, a <code>pyarrow.Field</code>, or a
<code>pyarrow.DataType</code>.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="python"><span class="n">na</span><span class="p">.</span><span class="nf">int32</span><span class="p">()</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Schema(INT32)
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="python"><span class="n">na</span><span class="p">.</span><span class="nf">struct</span><span class="p">({</span><span class="sh">"</span><span class="s">col1</span><span class="sh">"</span><span class="p">:</span> <span class="n">na</span><span class="p">.</span><span class="nf">int32</span><span class="p">()})</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Schema(STRUCT, fields=[Schema(INT32, name='col1')])
</code></pre></div></div>
<p>The next release of nanoarrow for Python will include a user-facing <code>Array</code> class among other
improvements and features based on community feedback! For a more in-depth review of the
initial Python bindings, see the
<a href="https://arrow.apache.org/nanoarrow/latest/getting-started/python.html">Getting started in Python guide</a> and the
<a href="https://arrow.apache.org/nanoarrow/latest/reference/python.html">Python API reference</a></p>
<h2>Contributors</h2>
<p>This release consists of contributions from 4 contributors in addition
to the invaluable advice and support of the Apache Arrow developer mailing list.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>git shortlog <span class="nt">-sn</span> 798a1b8f096c84e2b6f887427649f1cb496412b2..apache-arrow-nanoarrow-0.4.0 | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"GitHub Actions"</span>
<span class="go">  35  Dewey Dunnington
  3  William Ayd
  2  Dirk Eddelbuettel
  2  Joris Van den Bossche
  1  eitsupi
</span></code></pre></div></div>

      </main>
    </div>

    <hr>
<footer class="footer">
  <div class="row">
    <div class="col-md-9">
      <p>Apache Arrow, Arrow, Apache, the Apache logo, and the Apache Arrow project logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
      <p> 2016-2025 The Apache Software Foundation</p>
    </div>
    <div class="col-md-3">
      <a class="d-sm-none d-md-inline pr-2" href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener">
        <img src="https://www.apache.org/events/current-event-234x60.png">
      </a>
    </div>
  </div>
</footer>

  </div>
</body>
</html>
